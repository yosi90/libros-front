import{a as Y,d as Se,e as Ue,f as De,g as fe,h as ge,i as _e,j as Ni,l as Fi,m as Ri,n as Vi,o as pt,p as q}from"./chunk-MRMND2JK.js";import{$ as bi,Aa as le,Ba as ki,C as Dt,D as dt,Da as Oi,Ea as ce,F as fi,Fa as Ve,Ga as L,Ha as de,Ia as me,Ja as pe,O as gi,R as Lt,Sa as Ei,Ta as Pi,Wa as Ai,Z as _i,_ as vi,_a as Ii,a as G,aa as we,b as Fe,ba as xi,bb as Ye,ca as Ci,da as jt,eb as Bi,fa as Mi,fb as k,ga as Q,gb as ue,hb as Ti,i as di,ia as u,ib as he,jb as y,k as D,ka as J,kb as Le,l as mi,la as X,lb as Ce,mb as K,n as pi,na as S,nb as j,oa as Z,ob as Ie,pa as Re,pb as ut,qa as ee,r as ui,s as ct,sa as te,ta as ie,ua as re,va as ye,wa as ae,x as hi,xa as oe,ya as ne,za as se}from"./chunk-AH2YT6K2.js";import{$ as Me,$b as v,$c as Ke,Bb as w,C as M,Cb as W,D as it,Db as V,Dc as si,Eb as U,Fa as Et,Fb as n,G as $,Ga as Ne,Gb as s,Hb as O,Hc as li,Ic as ci,Jc as st,K as He,Lb as E,M as Yt,Ob as _,Pc as lt,Qb as h,Qc as N,Rb as ai,Sb as oi,Tb as It,Ub as ni,Vb as Bt,Wb as Tt,X as Ee,Xb as ze,Xc as wi,Y as rt,Yb as $e,Yc as mt,Za as ei,Zb as xe,Zc as Si,_b as c,ab as Pt,ac as P,ad as yi,ba as Qt,bc as Nt,ca as Be,cb as l,cc as Ft,cd as qt,d as R,da as at,db as p,dc as Rt,e as kt,ec as Vt,fa as Ot,fb as ti,fc as T,ha as Te,ia as Jt,j as Wt,kc as We,lb as ii,lc as Ge,ma as I,mb as ri,mc as nt,na as B,oa as ot,p as Gt,pa as Xt,pb as At,q as z,t as Oe,tb as b,tc as Ut,ub as Pe,va as Zt,vb as f,wa as x,x as Kt,xa as C,xc as Ae,z as tt}from"./chunk-TEWAPIBS.js";var rr=(r,o)=>o.bookId;function ar(r,o){if(r&1){let a=E();n(0,"div",1),_("click",function(){let t=x(a).$implicit,i=h();return C(i.openBook(t.bookId))}),n(1,"div",2)(2,"div",3),O(3,"img",4),n(4,"mat-icon",5),c(5),s()(),n(6,"h4",6),c(7),s()()()}if(r&2){let a=o.$implicit,e=h();l(3),ni("src","http://localhost:8080/api/v1/image/",e.userData.userId,"/",a.cover,"",ei),l(),It("matTooltip",a.status.name),l(),v(a.status.statusId===1?"add_shopping_cart":a.status.statusId===2?"book":a.status.statusId===3?"local_library":"done_all"),l(),It("matTooltip",a.name),l(),v(a.name)}}function or(r,o){r&1&&(n(0,"div")(1,"h2"),c(2,"A\xFAn no tienes libros"),s(),n(3,"h3",7),c(4,"Prueba a introducir un nuevo "),n(5,"a",8),c(6,"libro"),s()(),n(7,"h3"),c(8,"pero no olvides crear antes su "),n(9,"a",9),c(10,"autor"),s(),c(11,", "),n(12,"a",10),c(13,"universo"),s(),c(14," y "),n(15,"a",11),c(16,"saga"),s()()())}var Ui=(()=>{let o=class o{constructor(e,t,i,d,m,g){this.loginSrv=e,this.userSrv=t,this.bookSrv=i,this.router=d,this._snackBar=m,this.route=g,this.userData={userId:-1,name:"",email:""};let F=this.loginSrv.token;F!=null&&F!=""&&this.userSrv.getUser(F).subscribe({next:be=>R(this,null,function*(){this.userData=be}),error:()=>{this.loginSrv.logout(),this.router.navigateByUrl("/home")}})}ngOnInit(){this.route.queryParams.subscribe(e=>{e.authorAdded==="true"&&this._snackBar.openSnackBar("Autor a\xF1adido","successBar"),e.universeAdded==="true"&&this._snackBar.openSnackBar("Universo a\xF1adido","successBar"),e.sagaAdded==="true"&&this._snackBar.openSnackBar("Saga a\xF1adida","successBar"),e.bookAdded==="true"&&this._snackBar.openSnackBar("Libro a\xF1adido","successBar")})}openBook(e){this.router.navigate(["book",e])}};o.\u0275fac=function(t){return new(t||o)(p(j),p(q),p(ut),p(D),p(y),p(di))},o.\u0275cmp=B({type:o,selectors:[["app-books"]],standalone:!0,features:[T],decls:3,vars:1,consts:[[1,"contain"],[1,"contain",3,"click"],[1,"item","px-1","pt-2","pb-1"],[1,"layer"],["alt","Portada del libro",3,"src"],["matTooltipClass","tt-accent tt-multiline",3,"matTooltip"],[1,"pt-2","pb-0","mb-0",3,"matTooltip"],["id","init"],["routerLink","/dashboard/addBook"],["routerLink","/dashboard/addAuthor"],["routerLink","/dashboard/addUniverse"],["routerLink","/dashboard/addSaga"]],template:function(t,i){t&1&&V(0,ar,8,7,"div",0,rr,!1,or,17,0,"div"),t&2&&U(i.userData.books)},dependencies:[pt,N,Ni,L,mi,y],styles:['@keyframes _ngcontent-%COMP%_breathing-shadow{0%{box-shadow:5px 5px 5px #17171780,-1px -1px 5px #17171780}50%{box-shadow:8px 8px 8px #171717b3,-1px -1px 5px #171717b3}to{box-shadow:5px 5px 5px #17171780,-1px -1px 5px #17171780}}@keyframes _ngcontent-%COMP%_breathing-shadow-text{0%{text-shadow:5px 5px 5px rgba(23,23,23,.5),-1px -1px 5px rgba(23,23,23,.5)}50%{text-shadow:8px 8px 8px rgba(23,23,23,.7),-1px -1px 5px rgba(23,23,23,.7)}to{text-shadow:5px 5px 5px rgba(23,23,23,.5),-1px -1px 5px rgba(23,23,23,.5)}}  .cdk-overlay-pane:has(.errorBar){position:absolute!important;top:50px}  .cdk-overlay-pane:has(.errorBar) .mdc-snackbar__surface{background-color:#df4141!important;color:#2c2a2a}  .cdk-overlay-pane:has(.errorBarMenu){position:absolute!important;top:350px;left:50px}  .cdk-overlay-pane:has(.errorBarMenu) .mdc-snackbar__surface{background-color:#df4141!important;color:#2c2a2a}  .cdk-overlay-pane:has(.successBar){margin-top:50px!important}  .cdk-overlay-pane:has(.successBar) .mdc-snackbar__surface{background-color:#26da5c!important}  .cdk-overlay-pane:has(.successBar) .mdc-snackbar__surface .mat-mdc-snack-bar-label{color:#000}  .cdk-overlay-pane:has(.successBar) .mdc-snackbar__surface .mdc-button__label{color:#6c198a}  .cdk-overlay-pane:has(.successBarMenu){position:absolute!important;top:350px;left:50px}  .cdk-overlay-pane:has(.successBarMenu) .mdc-snackbar__surface{background-color:#26da5c!important}  .cdk-overlay-pane:has(.successBarMenu) .mdc-snackbar__surface .mat-mdc-snack-bar-label{color:#000}  .cdk-overlay-pane:has(.successBarMenu) .mdc-snackbar__surface .mdc-button__label{color:#6c198a}  .cdk-overlay-pane:has(.successBar-margin){margin-top:120px!important}  .cdk-overlay-pane:has(.successBar-margin) .mdc-snackbar__surface{background-color:#26da5c!important}  .cdk-overlay-pane:has(.successBar-margin) .mdc-snackbar__surface .mat-mdc-snack-bar-label{color:#000}  .cdk-overlay-pane:has(.successBar-margin) .mdc-snackbar__surface .mdc-button__label{color:#6c198a}  .tt-accent *{background-color:#c2185b!important}  .tt-multiline{white-space:pre-line;text-align:start}[_nghost-%COMP%]{display:flex;flex-flow:row wrap;justify-content:start;align-items:start;height:100%;max-height:100%;overflow:auto;gap:50px}[_nghost-%COMP%]   div[_ngcontent-%COMP%]{display:flex;justify-content:center;flex-flow:row wrap}[_nghost-%COMP%]   div[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{width:50%;font-size:5rem;text-align:center;background-color:#ffffff2b;border-radius:14px;box-shadow:1px 1px 2px #00000059;padding:20px;margin-top:10%}[_nghost-%COMP%]   div[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{width:65%;font-size:40px;text-align:center;background-color:#ffffff2b;border-radius:14px;box-shadow:1px 1px 2px #00000059;padding:16px}[_nghost-%COMP%]   div[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none;background-color:#ffffff2b;border-radius:14px;box-shadow:1px 1px 2px #00000059;cursor:pointer;transition:all .3s;padding:0 15px}[_nghost-%COMP%]   div[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{background-color:#ffffff73;box-shadow:1px 1px 2px #00000073}[_nghost-%COMP%]   div[_ngcontent-%COMP%]   #init[_ngcontent-%COMP%]{width:55%;margin-top:5%}.contain[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;line-height:1.5em;gap:50px}.contain[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{position:relative;width:170px;background-color:#00000080;border-radius:10px;box-shadow:0 1px 2px #3c40434d,0 1px 3px 1px #3c404326;cursor:pointer}.contain[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]:after{content:"";position:absolute;top:8px;left:0;height:80%;border-style:solid;border-color:transparent transparent transparent rgba(0,0,0,.7);border-width:40px 40px 40px 40px;box-sizing:border-box;filter:drop-shadow(5px 0 4px rgba(0,0,0,.5803921569));transition:filter .5s;z-index:2}.contain[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]:hover:after{filter:drop-shadow(5px 0 4px rgba(0,0,0,.1019607843))}.contain[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .layer[_ngcontent-%COMP%]{position:relative;left:10px;height:224px;border:1px solid #292929;border-radius:3px;box-shadow:0 1px 2px #00000012,0 2px 4px #00000012,0 4px 8px #00000012,0 8px 16px #00000012,0 8px 32px #00000012,0 32px 64px #00000012;transition:left 1s;overflow:hidden}.contain[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .layer[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%}.contain[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   .layer[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{position:absolute;right:5px;bottom:5px;display:grid;place-content:center;width:40px;height:40px;font-size:14px;color:#fff;background-color:#000000e6;border-radius:20%;box-shadow:0 1px 2px #00000012,0 2px 4px #00000012,0 4px 8px #00000012,0 8px 16px #00000012,0 8px 32px #00000012,0 32px 64px #00000012}.contain[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]:hover   .layer[_ngcontent-%COMP%]{left:40px}.contain[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:14px;text-align:center;color:#fff;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;padding:10px}@media screen and (max-width: 1050px){[_nghost-%COMP%]   div[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{width:95%;font-size:2rem;padding:7px}[_nghost-%COMP%]   div[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{width:95%;font-size:1.5rem;padding:7px}}']});let r=o;return r})();function nr(r,o){if(r&1){let a=E();n(0,"li",6),_("click",function(){x(a);let t=h();return C(t.invertModName())}),n(1,"mat-icon",7),c(2,"account_box"),s(),c(3),s()}if(r&2){let a=h();l(3),P(" ",a.userData.name," ")}}function sr(r,o){if(r&1&&(n(0,"mat-error",14),c(1),s()),r&2){let a=h(2);l(),v(a.errorNameMessage)}}function lr(r,o){if(r&1&&(n(0,"div",18),O(1,"ngx-loading",19),s()),r&2){let a=h(2);l(),f("show",a.waitingServerResponse)("config",a.spinnerConfig)}}function cr(r,o){if(r&1){let a=E();n(0,"li",8)(1,"form",9),_("submit",function(){let t;x(a);let i=h();return C(i.updateName((t=i.name.value)!==null&&t!==void 0?t:""))}),n(2,"mat-form-field",10)(3,"mat-label",11),c(4,"Nombre"),s(),n(5,"input",12),_("blur",function(){x(a);let t=h();return C(t.updateNameErrorMessage())}),s(),n(6,"mat-icon",13),c(7,"account_box"),s(),b(8,sr,2,1,"mat-error",14),n(9,"mat-hint",15),c(10),s()(),n(11,"div",16)(12,"button",17),c(13," Actualizar "),n(14,"mat-icon"),c(15,"border_color"),s()(),b(16,lr,2,2,"div",18),s()()()}if(r&2){let a=h();l(),f("formGroup",a.fgName),l(7),w(8,a.name.invalid?8:-1),l(2),P("",a.name.value?a.name.value.length:0," / 15"),l(2),f("disabled",a.fgName.invalid||a.waitingServerResponse),l(4),w(16,a.waitingServerResponse?16:-1)}}function dr(r,o){if(r&1){let a=E();n(0,"li",6),_("click",function(){x(a);let t=h();return C(t.invertModEmail())}),n(1,"mat-icon",7),c(2,"email"),s(),c(3),s()}if(r&2){let a=h();l(3),P(" ",a.userData.email," ")}}function mr(r,o){if(r&1&&(n(0,"mat-error",14),c(1),s()),r&2){let a=h(2);l(),v(a.errorEmailMessage)}}function pr(r,o){if(r&1&&(n(0,"div",18),O(1,"ngx-loading",19),s()),r&2){let a=h(2);l(),f("show",a.waitingServerResponse)("config",a.spinnerConfig)}}function ur(r,o){if(r&1){let a=E();n(0,"li",8)(1,"form",9),_("submit",function(){let t;x(a);let i=h();return C(i.updateEmail((t=i.email.value)!==null&&t!==void 0?t:""))}),n(2,"mat-form-field",20)(3,"mat-label",11),c(4,"Correo electr\xF3nico"),s(),n(5,"input",21),_("blur",function(){x(a);let t=h();return C(t.updateEmailErrorMessage())}),s(),n(6,"mat-icon",13),c(7,"email"),s(),b(8,mr,2,1,"mat-error",14),n(9,"mat-hint",15),c(10),s()(),n(11,"div",16)(12,"button",17),c(13," Actualizar "),n(14,"mat-icon"),c(15,"border_color"),s()(),b(16,pr,2,2,"div",18),s()()()}if(r&2){let a=h();l(),f("formGroup",a.fgEmail),l(7),w(8,a.email.invalid?8:-1),l(2),P("",a.email.value?a.email.value.length:0," / 30"),l(2),f("disabled",a.fgEmail.invalid||a.waitingServerResponse),l(4),w(16,a.waitingServerResponse?16:-1)}}function hr(r,o){if(r&1){let a=E();n(0,"li",6),_("click",function(){x(a);let t=h();return C(t.invertModPassword())}),n(1,"mat-icon",7),c(2,"password"),s(),c(3," Actualizar la contrase\xF1a "),s()}}function fr(r,o){if(r&1&&(n(0,"mat-error"),c(1),s()),r&2){let a=h(2);l(),v(a.errorPasswordOldMessage)}}function gr(r,o){if(r&1&&(n(0,"mat-error"),c(1),s()),r&2){let a=h(2);l(),v(a.errorPasswordNewMessage)}}function _r(r,o){if(r&1&&(n(0,"mat-error"),c(1),s()),r&2){let a=h(2);l(),v(a.errorPasswordRepeatMessage)}}function vr(r,o){if(r&1&&(n(0,"div",18),O(1,"ngx-loading",19),s()),r&2){let a=h(2);l(),f("show",a.waitingServerResponse)("config",a.spinnerConfig)}}function br(r,o){if(r&1){let a=E();n(0,"li",8)(1,"form",9),_("submit",function(){x(a);let t=h();return C(t.updatePassword())}),n(2,"mat-form-field",22)(3,"mat-label",11),c(4,"Contrase\xF1a actual"),s(),n(5,"input",23),_("blur",function(){x(a);let t=h();return C(t.updatePasswordOldErrorMessage())}),s(),n(6,"mat-icon",13),c(7,"password"),s(),n(8,"button",24),_("click",function(){x(a);let t=h();return C(t.passOldHide=!t.passOldHide)}),n(9,"mat-icon"),c(10),s()(),b(11,fr,2,1,"mat-error"),n(12,"mat-hint",15),c(13),s()(),n(14,"mat-form-field",22)(15,"mat-label",11),c(16,"Contrase\xF1a nueva"),s(),n(17,"input",25),_("blur",function(){x(a);let t=h();return C(t.updatePasswordNewErrorMessage())}),s(),n(18,"mat-icon",13),c(19,"password"),s(),n(20,"button",24),_("click",function(){x(a);let t=h();return C(t.passNewHide=!t.passNewHide)}),n(21,"mat-icon"),c(22),s()(),b(23,gr,2,1,"mat-error"),n(24,"mat-hint",15),c(25),s()(),n(26,"mat-form-field",22)(27,"mat-label",11),c(28,"Confirma la contrase\xF1a"),s(),n(29,"input",26),_("blur",function(){x(a);let t=h();return C(t.updatePasswordRepeatErrorMessage())}),s(),n(30,"mat-icon",13),c(31,"password"),s(),n(32,"button",24),_("click",function(){x(a);let t=h();return C(t.passRepHide=!t.passRepHide)}),n(33,"mat-icon"),c(34),s()(),b(35,_r,2,1,"mat-error"),n(36,"mat-hint",15),c(37),s()(),n(38,"div",16)(39,"button",17),c(40," Actualizar "),n(41,"mat-icon"),c(42,"border_color"),s()(),b(43,vr,2,2,"div",18),s()()()}if(r&2){let a=h();l(),f("formGroup",a.fgPassword),l(4),f("type",a.passOldHide?"password":"text"),l(3),Pe("aria-label","Esconder contrase\xF1a")("aria-pressed",a.passOldHide),l(2),v(a.passOldHide?"visibility_off":"visibility"),l(),w(11,a.passwordOld.invalid?11:-1),l(2),P("",a.passwordOld.value?a.passwordOld.value.length:0," / 30"),l(4),f("type",a.passNewHide?"password":"text"),l(3),Pe("aria-label","Esconder contrase\xF1a")("aria-pressed",a.passNewHide),l(2),v(a.passNewHide?"visibility_off":"visibility"),l(),w(23,a.passwordNew.invalid?23:-1),l(2),P("",a.passwordNew.value?a.passwordNew.value.length:0," / 30"),l(4),f("type",a.passRepHide?"password":"text"),l(3),Pe("aria-label","Esconder contrase\xF1a")("aria-pressed",a.passRepHide),l(2),v(a.passRepHide?"visibility_off":"visibility"),l(),w(35,a.passwordRepeat.invalid?35:-1),l(2),P("",a.passwordRepeat.value?a.passwordRepeat.value.length:0," / 30"),l(2),f("disabled",a.fgPassword.invalid||a.waitingServerResponse),l(4),w(43,a.waitingServerResponse?43:-1)}}var Li=(()=>{let o=class o{constructor(e,t,i,d,m){this.loginSrv=e,this.userSrv=t,this.fBuild=i,this.router=d,this._snackBar=m,this.userData={userId:0,name:"",email:""},this.waitingServerResponse=!1,this.spinnerConfig={animationType:fe.chasingDots,primaryColour:"#afcec2",secondaryColour:"#000000"},this.modName=!1,this.errorNameMessage="",this.name=new S("",[u.required,u.pattern("^[a-zA-Z]{3,15}"),u.minLength(3),u.maxLength(15)]),this.fgName=this.fBuild.group({name:this.name}),this.modEmail=!1,this.errorEmailMessage="",this.email=new S("",[u.required,u.email,u.maxLength(30)]),this.fgEmail=this.fBuild.group({email:this.email}),this.modPassword=!1,this.errorPasswordOldMessage="",this.passOldHide=!0,this.errorPasswordNewMessage="",this.passNewHide=!0,this.errorPasswordRepeatMessage="",this.passRepHide=!0,this.passwordOld=new S("",[u.required,u.pattern("^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[@$!%*?&#\xF1\xD1])[A-Za-z\\d@$!%*?&#\xF1\xD1]{8,}$"),u.minLength(8),u.maxLength(30)]),this.passwordNew=new S("",[u.required,u.pattern("^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[@$!%*?&#\xF1\xD1])[A-Za-z\\d@$!%*?&#\xF1\xD1]{8,}$"),u.minLength(8),u.maxLength(30)]),this.passwordRepeat=new S("",[u.required,u.pattern("^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)(?=.*[@$!%*?&#\xF1\xD1])[A-Za-z\\d@$!%*?&#\xF1\xD1]{8,}$"),u.minLength(8),u.maxLength(30)]),this.fgPassword=this.fBuild.group({passwordOld:this.passwordOld,passwordNew:this.passwordNew,passwordRepeat:this.passwordRepeat}),M(this.name.statusChanges,this.name.valueChanges).pipe(k()).subscribe(()=>this.updateNameErrorMessage()),M(this.email.statusChanges,this.email.valueChanges).pipe(k()).subscribe(()=>this.updateEmailErrorMessage()),M(this.passwordOld.statusChanges,this.passwordOld.valueChanges).pipe(k()).subscribe(()=>this.updatePasswordOldErrorMessage()),M(this.passwordNew.statusChanges,this.passwordNew.valueChanges).pipe(k()).subscribe(()=>this.updatePasswordNewErrorMessage()),M(this.passwordRepeat.statusChanges,this.passwordRepeat.valueChanges).pipe(k()).subscribe(()=>this.updatePasswordRepeatErrorMessage())}ngOnInit(){let e=this.loginSrv.token;e!=null&&e!=""&&this.userSrv.getUser(e).subscribe({next:t=>R(this,null,function*(){this.userData=t,this.name.setValue(this.userData.name),this.email.setValue(this.userData.email)}),error:()=>{this.loginSrv.logout(),this.router.navigateByUrl("/home")}})}handleEscapeEvent(){this.modName===!0&&this.invertModName(),this.modEmail===!0&&this.invertModEmail(),this.modPassword===!0&&this.invertModPassword()}handleEnterEvent(){this.modPassword===!0&&this.fgPassword.valid&&this.updatePassword()}updateNameErrorMessage(){this.name.hasError("required")?this.errorNameMessage="El nombre no puede quedar vac\xEDo":this.name.hasError("minlength")?this.errorNameMessage="Nombre demasiado corto":this.name.hasError("maxlength")?this.errorNameMessage="Nombre demasiado largo":this.errorNameMessage="Nombre no v\xE1lido"}updateEmailErrorMessage(){this.email.hasError("required")?this.errorEmailMessage="El email no puede quedar vac\xEDo":this.email.hasError("maxlength")?this.errorEmailMessage="Email demasiado largo":this.errorEmailMessage="Email no v\xE1lido"}updatePasswordOldErrorMessage(){this.passwordOld.hasError("required")?this.errorPasswordOldMessage="Debes introducir la contrase\xF1a previa":this.passwordOld.hasError("minlength")?this.errorPasswordOldMessage="Contrase\xF1a demasiado corta":this.passwordOld.hasError("maxlength")?this.errorPasswordOldMessage="Contrase\xF1a demasiado larga":this.errorPasswordOldMessage=""}updatePasswordNewErrorMessage(){this.passwordNew.hasError("required")?this.errorPasswordNewMessage="La contrase\xF1a nueva no puede quedar vac\xEDa":this.passwordNew.hasError("minlength")?this.errorPasswordNewMessage="Contrase\xF1a demasiado corta":this.passwordNew.hasError("maxlength")?this.errorPasswordNewMessage="Contrase\xF1a demasiado larga":this.passwordNew.value!=this.passwordRepeat.value&&this.passwordRepeat.value?(this.errorPasswordNewMessage="Las contrase\xF1as no coinciden",this.passwordNew.setErrors({"Las contrase\xF1as no coinciden":!0})):this.passwordOld.value==this.passwordNew.value?(this.errorPasswordNewMessage="La contrase\xF1a nueva debe ser distinta a la anterior",this.passwordNew.setErrors({"La contrase\xF1a nueva debe ser distinta a la anterior":!0})):this.errorPasswordNewMessage=""}updatePasswordRepeatErrorMessage(){this.passwordRepeat.hasError("required")?this.errorPasswordRepeatMessage="Debes confirmar la contrase\xF1a nueva":this.passwordRepeat.hasError("minlength")?this.errorPasswordRepeatMessage="Contrase\xF1a demasiado corta":this.passwordRepeat.hasError("maxlength")?this.errorPasswordRepeatMessage="Contrase\xF1a demasiado larga":this.passwordNew.value!=this.passwordRepeat.value?(this.errorPasswordRepeatMessage="Las contrase\xF1as no coinciden",this.passwordRepeat.setErrors({"Las contrase\xF1as no coinciden":!0})):this.passwordOld.value==this.passwordRepeat.value?(this.errorPasswordRepeatMessage="La contrase\xF1a nueva debe ser distinta a la anterior",this.passwordRepeat.setErrors({"La contrase\xF1a nueva debe ser distinta a la anterior":!0})):this.errorPasswordRepeatMessage=""}invertModName(){this.modName=!this.modName,this.modName===!0&&(this.name.setValue(this.userData?.name??""),this.modEmail===!0&&this.invertModEmail(),this.modPassword===!0&&this.invertModPassword())}updateName(e){if(this.fgName.invalid||e==this.userData?.name){this._snackBar.openSnackBar("Error: "+this.fgName.errors,"errorBar");return}this.waitingServerResponse=!0;let t=this.loginSrv.token;this.userSrv.updateName(e,t).subscribe({next:i=>{this.userData=i,this.modName=!this.modName,this._snackBar.openSnackBar("Nombre actualizado","successBar"),this.waitingServerResponse=!1},error:i=>{this._snackBar.openSnackBar(i,"errorBar"),this.waitingServerResponse=!1}})}invertModEmail(){this.modEmail=!this.modEmail,this.modEmail===!0&&(this.email.setValue(this.userData?.email??""),this.modName===!0&&this.invertModName(),this.modPassword===!0&&this.invertModPassword())}updateEmail(e){if(this.fgEmail.invalid||e==this.userData?.email){this._snackBar.openSnackBar("Error: "+this.fgEmail.errors,"errorBar");return}this.waitingServerResponse=!0;let t=this.loginSrv.token;this.userSrv.updateEmail(e,t).subscribe({next:i=>{this.userData=i,this.modEmail=!this.modEmail,this._snackBar.openSnackBar("Email actualizado","successBar"),this.waitingServerResponse=!1},error:i=>{this._snackBar.openSnackBar(i,"errorBar"),this.waitingServerResponse=!1}})}invertModPassword(){this.modPassword=!this.modPassword,this.modPassword===!0?(this.modName===!0&&this.invertModName(),this.modEmail===!0&&this.invertModEmail()):(this.fgPassword.reset(),this.fgPassword.markAsUntouched())}updatePassword(){if(this.fgPassword.invalid){this._snackBar.openSnackBar("Error: "+this.fgPassword.errors,"errorBar");return}this.waitingServerResponse=!0;let e=this.loginSrv.token;this.userSrv.updatePassword(this.fgPassword.value.passwordNew??"",this.fgPassword.value.passwordOld??"",e).subscribe({next:t=>{this.userData=t,this.modPassword=!this.modPassword,this._snackBar.openSnackBar("Contrase\xF1a actualizada","successBar"),this.waitingServerResponse=!1},error:t=>{this._snackBar.openSnackBar(t,"errorBar"),this.waitingServerResponse=!1}})}};o.\u0275fac=function(t){return new(t||o)(p(j),p(q),p(re),p(D),p(y))},o.\u0275cmp=B({type:o,selectors:[["app-user-profile"]],hostBindings:function(t,i){t&1&&_("keydown.escape",function(m){return i.handleEscapeEvent(m)},!1,Pt)("keydown.enter",function(m){return i.handleEnterEvent(m)},!1,Pt)},standalone:!0,features:[T],decls:22,vars:6,consts:[["inputName",""],["inputEmail",""],["inputPassword",""],[1,"p-3"],[3,"click",4,"ngIf","ngIfElse"],["behavior","scroll","direction","left",1,"d-flex","align-items-center","fw-bold"],[3,"click"],[1,"me-2"],[1,"input-mod"],[3,"submit","formGroup"],["appearance","outline",1,"w-100","text-white","mt-3","mb-2"],[1,"ms-3"],["matInput","","formControlName","name","required","",1,"ms-3",3,"blur"],["matTextPrefix",""],["align","start"],["align","end"],[1,"position-relative"],["mat-raised-button","","type","submit",3,"disabled"],[1,"spinner-wrapper"],[3,"show","config"],["appearance","outline","primary","",1,"w-100","mt-3","mb-2"],["matInput","","formControlName","email","required","",1,"ms-3",3,"blur"],["appearance","outline",1,"w-100","mb-3"],["matInput","","formControlName","passwordOld","required","",1,"ms-3",3,"blur","type"],["type","button","mat-icon-button","","matSuffix","",3,"click"],["matInput","","formControlName","passwordNew","required","",1,"ms-3",3,"blur","type"],["matInput","","formControlName","passwordRepeat","required","",1,"ms-3",3,"blur","type"]],template:function(t,i){if(t&1&&(n(0,"mat-card",3)(1,"ul"),b(2,nr,4,1,"li",4)(3,cr,17,5,"ng-template",null,0,nt)(5,dr,4,1,"li",4)(6,ur,17,5,"ng-template",null,1,nt)(8,hr,4,0,"li",4)(9,br,44,21,"ng-template",null,2,nt),O(11,"hr"),n(12,"marquee",5)(13,"mat-icon"),c(14,"ads_click"),s(),c(15," en un campo y "),n(16,"kbd"),c(17,"enter"),s(),c(18," para actualizar \xA0\xA0\xA0\xA0\xA0\xA0\xA0\xA0\xA0\xA0\xA0\xA0\xA0\xA0 "),n(19,"kbd"),c(20,"scape"),s(),c(21," para cancelar una edici\xF3n "),s()()()),t&2){let d=xe(4),m=xe(7),g=xe(10);l(2),f("ngIf",i.modName===!1)("ngIfElse",d),l(3),f("ngIf",i.modEmail===!1)("ngIfElse",m),l(3),f("ngIf",i.modPassword===!1)("ngIfElse",g)}},dependencies:[Se,Y,Ve,ce,oe,se,ne,le,ki,ae,Z,Q,J,X,ie,ee,te,pe,me,he,ue,Ti,_e,ge,de,L,N,st,y],styles:['form[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]     .mat-mdc-form-field-flex{align-items:center!important}form[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]     .mat-mdc-form-field-flex .mat-mdc-form-field-text-prefix{display:flex}form[_ngcontent-%COMP%]   .spinner-wrapper[_ngcontent-%COMP%]{position:absolute;right:25%}  .cdk-overlay-pane:has(.errorBar){position:absolute!important;top:50px}  .cdk-overlay-pane:has(.errorBar) .mdc-snackbar__surface{background-color:#df4141!important;color:#2c2a2a}  .cdk-overlay-pane:has(.errorBarMenu){position:absolute!important;top:350px;left:50px}  .cdk-overlay-pane:has(.errorBarMenu) .mdc-snackbar__surface{background-color:#df4141!important;color:#2c2a2a}  .cdk-overlay-pane:has(.successBar){margin-top:50px!important}  .cdk-overlay-pane:has(.successBar) .mdc-snackbar__surface{background-color:#26da5c!important}  .cdk-overlay-pane:has(.successBar) .mdc-snackbar__surface .mat-mdc-snack-bar-label{color:#000}  .cdk-overlay-pane:has(.successBar) .mdc-snackbar__surface .mdc-button__label{color:#6c198a}  .cdk-overlay-pane:has(.successBarMenu){position:absolute!important;top:350px;left:50px}  .cdk-overlay-pane:has(.successBarMenu) .mdc-snackbar__surface{background-color:#26da5c!important}  .cdk-overlay-pane:has(.successBarMenu) .mdc-snackbar__surface .mat-mdc-snack-bar-label{color:#000}  .cdk-overlay-pane:has(.successBarMenu) .mdc-snackbar__surface .mdc-button__label{color:#6c198a}  .cdk-overlay-pane:has(.successBar-margin){margin-top:120px!important}  .cdk-overlay-pane:has(.successBar-margin) .mdc-snackbar__surface{background-color:#26da5c!important}  .cdk-overlay-pane:has(.successBar-margin) .mdc-snackbar__surface .mat-mdc-snack-bar-label{color:#000}  .cdk-overlay-pane:has(.successBar-margin) .mdc-snackbar__surface .mdc-button__label{color:#6c198a}[_nghost-%COMP%]{display:flex;justify-content:center;align-items:center;height:100%}mat-card[_ngcontent-%COMP%]{width:100%;height:100%;background-color:#ac977d66;border-radius:4px;box-shadow:5px 5px 5px #171717}mat-card[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{position:relative;width:20%;height:100%;border-right:3px solid rgba(0,0,0,.2);list-style:none;gap:6px;padding-left:0;padding-right:17px;margin-bottom:0}mat-card[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:not(.input-mod){display:flex;justify-content:start;align-items:center;width:100%;background-color:#0000000d;border:solid black 1px;border-radius:4px;box-shadow:5px 5px 5px #171717;transition:all .3s;cursor:pointer;padding:8px;margin-bottom:.5rem}mat-card[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:not(.input-mod):hover{background-color:#00000026;box-shadow:7px 7px 7px #171717}mat-card[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li.input-mod[_ngcontent-%COMP%]{display:flex;justify-content:start;align-items:center;width:100%;-webkit-backdrop-filter:blur(2px);backdrop-filter:blur(2px);border-radius:14px;padding:10px}mat-card[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li.input-mod[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{width:100%}mat-card[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li.input-mod[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{color:#fff}mat-card[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li.input-mod[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     .mat-mdc-form-field-flex{align-items:center!important}mat-card[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li.input-mod[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     .mat-mdc-form-field-flex .mat-mdc-form-field-text-prefix{display:flex}mat-card[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   hr[_ngcontent-%COMP%]{height:30px;border-style:solid;border-color:#000;border-width:3px 0 0 0;border-radius:20px;overflow:visible;margin:25px -7px}mat-card[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   hr[_ngcontent-%COMP%]:before{content:"";display:block;height:30px;border-style:solid;border-color:#000;border-width:0 0 3px 0;border-radius:20px;margin-top:-31px}mat-card[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;justify-content:center;width:100%}mat-card[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   marquee[_ngcontent-%COMP%]{position:absolute;bottom:0}@media screen and (max-width: 1050px){marquee[_ngcontent-%COMP%]{display:none!important}}']});let r=o;return r})();document.querySelectorAll(".js-marquee").forEach(function(r){for(var o=r.querySelector("span")??document.createElement("span"),a=1;a<=3;++a){var e=o?.cloneNode(!0);o.after(e)}});var wr=["panel"],Sr=["*"];function yr(r,o){if(r&1){let a=E();n(0,"div",1,0),_("@panelAnimation.done",function(t){x(a);let i=h();return C(i._animationDone.next(t))}),oi(2),s()}if(r&2){let a=o.id,e=h();f("id",e.id)("ngClass",e._classList)("@panelAnimation",e.isOpen?"visible":"hidden"),Pe("aria-label",e.ariaLabel||null)("aria-labelledby",e._getPanelAriaLabelledby(a))}}var kr=wi("panelAnimation",[yi("void, hidden",Ke({opacity:0,transform:"scaleY(0.8)"})),qt(":enter, hidden => visible",[Si([mt("0.03s linear",Ke({opacity:1})),mt("0.12s cubic-bezier(0, 0, 0.2, 1)",Ke({transform:"scaleY(1)"}))])]),qt(":leave, visible => hidden",[mt("0.075s linear",Ke({opacity:0}))])]),Or=0,zt=class{constructor(o,a){this.source=o,this.option=a}},Hi=new Ot("mat-autocomplete-default-options",{providedIn:"root",factory:Er});function Er(){return{autoActiveFirstOption:!1,autoSelectActiveOption:!1,hideSingleSelectionIndicator:!1,requireSelection:!1}}var xt=(()=>{let o=class o{get isOpen(){return this._isOpen&&this.showPanel}_setColor(e){this._color=e,this._setThemeClasses(this._classList)}set classList(e){e&&e.length?this._classList=hi(e).reduce((t,i)=>(t[i]=!0,t),{}):this._classList={},this._setVisibilityClasses(this._classList),this._setThemeClasses(this._classList),this._elementRef.nativeElement.className=""}get hideSingleSelectionIndicator(){return this._hideSingleSelectionIndicator}set hideSingleSelectionIndicator(e){this._hideSingleSelectionIndicator=e,this._syncParentProperties()}_syncParentProperties(){if(this.options)for(let e of this.options)e._changeDetectorRef.markForCheck()}constructor(e,t,i,d){this._changeDetectorRef=e,this._elementRef=t,this._defaults=i,this._activeOptionChanges=kt.EMPTY,this._visibleClass="mat-mdc-autocomplete-visible",this._hiddenClass="mat-mdc-autocomplete-hidden",this._animationDone=new Ne,this.showPanel=!1,this._isOpen=!1,this.displayWith=null,this.optionSelected=new Ne,this.opened=new Ne,this.closed=new Ne,this.optionActivated=new Ne,this._classList={},this.id=`mat-autocomplete-${Or++}`,this.inertGroups=d?.SAFARI||!1,this.autoActiveFirstOption=!!i.autoActiveFirstOption,this.autoSelectActiveOption=!!i.autoSelectActiveOption,this.requireSelection=!!i.requireSelection,this._hideSingleSelectionIndicator=this._defaults.hideSingleSelectionIndicator??!1}ngAfterContentInit(){this._keyManager=new fi(this.options).withWrap().skipPredicate(this._skipPredicate),this._activeOptionChanges=this._keyManager.change.subscribe(e=>{this.isOpen&&this.optionActivated.emit({source:this,option:this.options.toArray()[e]||null})}),this._setVisibility()}ngOnDestroy(){this._keyManager?.destroy(),this._activeOptionChanges.unsubscribe(),this._animationDone.complete()}_setScrollTop(e){this.panel&&(this.panel.nativeElement.scrollTop=e)}_getScrollTop(){return this.panel?this.panel.nativeElement.scrollTop:0}_setVisibility(){this.showPanel=!!this.options.length,this._setVisibilityClasses(this._classList),this._changeDetectorRef.markForCheck()}_emitSelectEvent(e){let t=new zt(this,e);this.optionSelected.emit(t)}_getPanelAriaLabelledby(e){if(this.ariaLabel)return null;let t=e?e+" ":"";return this.ariaLabelledby?t+this.ariaLabelledby:e}_setVisibilityClasses(e){e[this._visibleClass]=this.showPanel,e[this._hiddenClass]=!this.showPanel}_setThemeClasses(e){e["mat-primary"]=this._color==="primary",e["mat-warn"]=this._color==="warn",e["mat-accent"]=this._color==="accent"}_skipPredicate(){return!1}};o.\u0275fac=function(t){return new(t||o)(p(Ut),p(Et),p(Hi),p(pi))},o.\u0275cmp=B({type:o,selectors:[["mat-autocomplete"]],contentQueries:function(t,i,d){if(t&1&&(Bt(d,we,5),Bt(d,vi,5)),t&2){let m;ze(m=$e())&&(i.options=m),ze(m=$e())&&(i.optionGroups=m)}},viewQuery:function(t,i){if(t&1&&(Tt(ti,7),Tt(wr,5)),t&2){let d;ze(d=$e())&&(i.template=d.first),ze(d=$e())&&(i.panel=d.first)}},hostAttrs:[1,"mat-mdc-autocomplete"],inputs:{ariaLabel:[I.None,"aria-label","ariaLabel"],ariaLabelledby:[I.None,"aria-labelledby","ariaLabelledby"],displayWith:"displayWith",autoActiveFirstOption:[I.HasDecoratorInputTransform,"autoActiveFirstOption","autoActiveFirstOption",Ae],autoSelectActiveOption:[I.HasDecoratorInputTransform,"autoSelectActiveOption","autoSelectActiveOption",Ae],requireSelection:[I.HasDecoratorInputTransform,"requireSelection","requireSelection",Ae],panelWidth:"panelWidth",disableRipple:[I.HasDecoratorInputTransform,"disableRipple","disableRipple",Ae],classList:[I.None,"class","classList"],hideSingleSelectionIndicator:[I.HasDecoratorInputTransform,"hideSingleSelectionIndicator","hideSingleSelectionIndicator",Ae]},outputs:{optionSelected:"optionSelected",opened:"opened",closed:"closed",optionActivated:"optionActivated"},exportAs:["matAutocomplete"],standalone:!0,features:[Vt([{provide:_i,useExisting:o}]),At,T],ngContentSelectors:Sr,decls:1,vars:0,consts:[["panel",""],["role","listbox",1,"mat-mdc-autocomplete-panel","mdc-menu-surface","mdc-menu-surface--open",3,"id","ngClass"]],template:function(t,i){t&1&&(ai(),b(0,yr,3,5,"ng-template"))},dependencies:[li],styles:["div.mat-mdc-autocomplete-panel{width:100%;max-height:256px;visibility:hidden;transform-origin:center top;overflow:auto;padding:8px 0;box-sizing:border-box;position:static;border-radius:var(--mat-autocomplete-container-shape);box-shadow:var(--mat-autocomplete-container-elevation-shadow);background-color:var(--mat-autocomplete-background-color)}.cdk-high-contrast-active div.mat-mdc-autocomplete-panel{outline:solid 1px}.cdk-overlay-pane:not(.mat-mdc-autocomplete-panel-above) div.mat-mdc-autocomplete-panel{border-top-left-radius:0;border-top-right-radius:0}.mat-mdc-autocomplete-panel-above div.mat-mdc-autocomplete-panel{border-bottom-left-radius:0;border-bottom-right-radius:0;transform-origin:center bottom}div.mat-mdc-autocomplete-panel.mat-mdc-autocomplete-visible{visibility:visible}div.mat-mdc-autocomplete-panel.mat-mdc-autocomplete-hidden{visibility:hidden;pointer-events:none}mat-autocomplete{display:none}"],encapsulation:2,data:{animation:[kr]},changeDetection:0});let r=o;return r})();var Pr={provide:Mi,useExisting:Qt(()=>et),multi:!0};var zi=new Ot("mat-autocomplete-scroll-strategy",{providedIn:"root",factory:()=>{let r=Jt(Ye);return()=>r.scrollStrategies.reposition()}});function Ar(r){return()=>r.scrollStrategies.reposition()}var Ir={provide:zi,deps:[Ye],useFactory:Ar},et=(()=>{let o=class o{constructor(e,t,i,d,m,g,F,be,qe,yt,er){this._element=e,this._overlay=t,this._viewContainerRef=i,this._zone=d,this._changeDetectorRef=m,this._dir=F,this._formField=be,this._document=qe,this._viewportRuler=yt,this._defaults=er,this._componentDestroyed=!1,this._manuallyFloatingLabel=!1,this._viewportSubscription=kt.EMPTY,this._canOpenOnNextFocus=!0,this._closeKeyEventStream=new Wt,this._windowBlurHandler=()=>{this._canOpenOnNextFocus=this._document.activeElement!==this._element.nativeElement||this.panelOpen},this._onChange=()=>{},this._onTouched=()=>{},this.position="auto",this.autocompleteAttribute="off",this._aboveClass="mat-mdc-autocomplete-panel-above",this._overlayAttached=!1,this.optionSelections=Kt(()=>{let H=this.autocomplete?this.autocomplete.options:null;return H?H.changes.pipe(Ee(H),rt(()=>M(...H.map(tr=>tr.onSelectionChange)))):this._zone.onStable.pipe(He(1),rt(()=>this.optionSelections))}),this._handlePanelKeydown=H=>{(H.keyCode===27&&!ct(H)||H.keyCode===38&&ct(H,"altKey"))&&(this._pendingAutoselectedOption&&(this._updateNativeInputValue(this._valueBeforeAutoSelection??""),this._pendingAutoselectedOption=null),this._closeKeyEventStream.next(),this._resetActiveItem(),H.stopPropagation(),H.preventDefault())},this._trackedModal=null,this._scrollStrategy=g}ngAfterViewInit(){let e=this._getWindow();typeof e<"u"&&this._zone.runOutsideAngular(()=>e.addEventListener("blur",this._windowBlurHandler))}ngOnChanges(e){e.position&&this._positionStrategy&&(this._setStrategyPositions(this._positionStrategy),this.panelOpen&&this._overlayRef.updatePosition())}ngOnDestroy(){let e=this._getWindow();typeof e<"u"&&e.removeEventListener("blur",this._windowBlurHandler),this._viewportSubscription.unsubscribe(),this._componentDestroyed=!0,this._destroyPanel(),this._closeKeyEventStream.complete(),this._clearFromModal()}get panelOpen(){return this._overlayAttached&&this.autocomplete.showPanel}openPanel(){this._openPanelInternal()}closePanel(){if(this._resetLabel(),!!this._overlayAttached&&(this.panelOpen&&this._zone.run(()=>{this.autocomplete.closed.emit()}),this.autocomplete._isOpen=this._overlayAttached=!1,this._pendingAutoselectedOption=null,this._overlayRef&&this._overlayRef.hasAttached()&&(this._overlayRef.detach(),this._closingActionsSubscription.unsubscribe()),this._updatePanelState(),this._componentDestroyed||this._changeDetectorRef.detectChanges(),this._trackedModal)){let e=this.autocomplete.id;dt(this._trackedModal,"aria-owns",e)}}updatePosition(){this._overlayAttached&&this._overlayRef.updatePosition()}get panelClosingActions(){return M(this.optionSelections,this.autocomplete._keyManager.tabOut.pipe(it(()=>this._overlayAttached)),this._closeKeyEventStream,this._getOutsideClickStream(),this._overlayRef?this._overlayRef.detachments().pipe(it(()=>this._overlayAttached)):Gt()).pipe(Oe(e=>e instanceof bi?e:null))}get activeOption(){return this.autocomplete&&this.autocomplete._keyManager?this.autocomplete._keyManager.activeItem:null}_getOutsideClickStream(){return M(tt(this._document,"click"),tt(this._document,"auxclick"),tt(this._document,"touchend")).pipe(it(e=>{let t=ui(e),i=this._formField?this._formField.getConnectedOverlayOrigin().nativeElement:null,d=this.connectedTo?this.connectedTo.elementRef.nativeElement:null;return this._overlayAttached&&t!==this._element.nativeElement&&this._document.activeElement!==this._element.nativeElement&&(!i||!i.contains(t))&&(!d||!d.contains(t))&&!!this._overlayRef&&!this._overlayRef.overlayElement.contains(t)}))}writeValue(e){Promise.resolve(null).then(()=>this._assignOptionValue(e))}registerOnChange(e){this._onChange=e}registerOnTouched(e){this._onTouched=e}setDisabledState(e){this._element.nativeElement.disabled=e}_handleKeydown(e){let t=e.keyCode,i=ct(e);if(t===27&&!i&&e.preventDefault(),this._valueOnLastKeydown=this._element.nativeElement.value,this.activeOption&&t===13&&this.panelOpen&&!i)this.activeOption._selectViaInteraction(),this._resetActiveItem(),e.preventDefault();else if(this.autocomplete){let d=this.autocomplete._keyManager.activeItem,m=t===38||t===40;t===9||m&&!i&&this.panelOpen?this.autocomplete._keyManager.onKeydown(e):m&&this._canOpen()&&this._openPanelInternal(this._valueOnLastKeydown),(m||this.autocomplete._keyManager.activeItem!==d)&&(this._scrollToOption(this.autocomplete._keyManager.activeItemIndex||0),this.autocomplete.autoSelectActiveOption&&this.activeOption&&(this._pendingAutoselectedOption||(this._valueBeforeAutoSelection=this._valueOnLastKeydown),this._pendingAutoselectedOption=this.activeOption,this._assignOptionValue(this.activeOption.value)))}}_handleInput(e){let t=e.target,i=t.value;if(t.type==="number"&&(i=i==""?null:parseFloat(i)),this._previousValue!==i){if(this._previousValue=i,this._pendingAutoselectedOption=null,(!this.autocomplete||!this.autocomplete.requireSelection)&&this._onChange(i),!i)this._clearPreviousSelectedOption(null,!1);else if(this.panelOpen&&!this.autocomplete.requireSelection){let d=this.autocomplete.options?.find(m=>m.selected);if(d){let m=this._getDisplayValue(d.value);i!==m&&d.deselect(!1)}}if(this._canOpen()&&this._document.activeElement===e.target){let d=this._valueOnLastKeydown??this._element.nativeElement.value;this._valueOnLastKeydown=null,this._openPanelInternal(d)}}}_handleFocus(){this._canOpenOnNextFocus?this._canOpen()&&(this._previousValue=this._element.nativeElement.value,this._attachOverlay(this._previousValue),this._floatLabel(!0)):this._canOpenOnNextFocus=!0}_handleClick(){this._canOpen()&&!this.panelOpen&&this._openPanelInternal()}_floatLabel(e=!1){this._formField&&this._formField.floatLabel==="auto"&&(e?this._formField._animateAndLockLabel():this._formField.floatLabel="always",this._manuallyFloatingLabel=!0)}_resetLabel(){this._manuallyFloatingLabel&&(this._formField&&(this._formField.floatLabel="auto"),this._manuallyFloatingLabel=!1)}_subscribeToClosingActions(){let e=this._zone.onStable.pipe(He(1)),t=this.autocomplete.options.changes.pipe(Me(()=>this._positionStrategy.reapplyLastPosition()),Yt(0));return M(e,t).pipe(rt(()=>(this._zone.run(()=>{let i=this.panelOpen;this._resetActiveItem(),this._updatePanelState(),this._changeDetectorRef.detectChanges(),this.panelOpen&&this._overlayRef.updatePosition(),i!==this.panelOpen&&(this.panelOpen?this._emitOpened():this.autocomplete.closed.emit())}),this.panelClosingActions)),He(1)).subscribe(i=>this._setValueAndClose(i))}_emitOpened(){this.autocomplete.opened.emit()}_destroyPanel(){this._overlayRef&&(this.closePanel(),this._overlayRef.dispose(),this._overlayRef=null)}_getDisplayValue(e){let t=this.autocomplete;return t&&t.displayWith?t.displayWith(e):e}_assignOptionValue(e){let t=this._getDisplayValue(e);e==null&&this._clearPreviousSelectedOption(null,!1),this._updateNativeInputValue(t??"")}_updateNativeInputValue(e){this._formField?this._formField._control.value=e:this._element.nativeElement.value=e,this._previousValue=e}_setValueAndClose(e){let t=this.autocomplete,i=e?e.source:this._pendingAutoselectedOption;i?(this._clearPreviousSelectedOption(i),this._assignOptionValue(i.value),this._onChange(i.value),t._emitSelectEvent(i),this._element.nativeElement.focus()):t.requireSelection&&this._element.nativeElement.value!==this._valueOnAttach&&(this._clearPreviousSelectedOption(null),this._assignOptionValue(null),t._animationDone?t._animationDone.pipe(He(1)).subscribe(()=>this._onChange(null)):this._onChange(null)),this.closePanel()}_clearPreviousSelectedOption(e,t){this.autocomplete?.options?.forEach(i=>{i!==e&&i.selected&&i.deselect(t)})}_openPanelInternal(e=this._element.nativeElement.value){if(this._attachOverlay(e),this._floatLabel(),this._trackedModal){let t=this.autocomplete.id;Dt(this._trackedModal,"aria-owns",t)}}_attachOverlay(e){this.autocomplete;let t=this._overlayRef;t?(this._positionStrategy.setOrigin(this._getConnectedElement()),t.updateSize({width:this._getPanelWidth()})):(this._portal=new Ai(this.autocomplete.template,this._viewContainerRef,{id:this._formField?.getLabelId()}),t=this._overlay.create(this._getOverlayConfig()),this._overlayRef=t,this._viewportSubscription=this._viewportRuler.change().subscribe(()=>{this.panelOpen&&t&&t.updateSize({width:this._getPanelWidth()})})),t&&!t.hasAttached()&&(t.attach(this._portal),this._valueOnAttach=e,this._valueOnLastKeydown=null,this._closingActionsSubscription=this._subscribeToClosingActions());let i=this.panelOpen;this.autocomplete._isOpen=this._overlayAttached=!0,this.autocomplete._setColor(this._formField?.color),this._updatePanelState(),this._applyModalPanelOwnership(),this.panelOpen&&i!==this.panelOpen&&this._emitOpened()}_updatePanelState(){if(this.autocomplete._setVisibility(),this.panelOpen){let e=this._overlayRef;this._keydownSubscription||(this._keydownSubscription=e.keydownEvents().subscribe(this._handlePanelKeydown)),this._outsideClickSubscription||(this._outsideClickSubscription=e.outsidePointerEvents().subscribe())}else this._keydownSubscription?.unsubscribe(),this._outsideClickSubscription?.unsubscribe(),this._keydownSubscription=this._outsideClickSubscription=null}_getOverlayConfig(){return new Ii({positionStrategy:this._getOverlayPosition(),scrollStrategy:this._scrollStrategy(),width:this._getPanelWidth(),direction:this._dir??void 0,panelClass:this._defaults?.overlayPanelClass})}_getOverlayPosition(){let e=this._overlay.position().flexibleConnectedTo(this._getConnectedElement()).withFlexibleDimensions(!1).withPush(!1);return this._setStrategyPositions(e),this._positionStrategy=e,e}_setStrategyPositions(e){let t=[{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"end",originY:"bottom",overlayX:"end",overlayY:"top"}],i=this._aboveClass,d=[{originX:"start",originY:"top",overlayX:"start",overlayY:"bottom",panelClass:i},{originX:"end",originY:"top",overlayX:"end",overlayY:"bottom",panelClass:i}],m;this.position==="above"?m=d:this.position==="below"?m=t:m=[...t,...d],e.withPositions(m)}_getConnectedElement(){return this.connectedTo?this.connectedTo.elementRef:this._formField?this._formField.getConnectedOverlayOrigin():this._element}_getPanelWidth(){return this.autocomplete.panelWidth||this._getHostWidth()}_getHostWidth(){return this._getConnectedElement().nativeElement.getBoundingClientRect().width}_resetActiveItem(){let e=this.autocomplete;if(e.autoActiveFirstOption){let t=-1;for(let i=0;i<e.options.length;i++)if(!e.options.get(i).disabled){t=i;break}e._keyManager.setActiveItem(t)}else e._keyManager.setActiveItem(-1)}_canOpen(){let e=this._element.nativeElement;return!e.readOnly&&!e.disabled&&!this.autocompleteDisabled}_getWindow(){return this._document?.defaultView||window}_scrollToOption(e){let t=this.autocomplete,i=xi(e,t.options,t.optionGroups);if(e===0&&i===1)t._setScrollTop(0);else if(t.panel){let d=t.options.toArray()[e];if(d){let m=d._getHostElement(),g=Ci(m.offsetTop,m.offsetHeight,t._getScrollTop(),t.panel.nativeElement.offsetHeight);t._setScrollTop(g)}}}_applyModalPanelOwnership(){let e=this._element.nativeElement.closest('body > .cdk-overlay-container [aria-modal="true"]');if(!e)return;let t=this.autocomplete.id;this._trackedModal&&dt(this._trackedModal,"aria-owns",t),Dt(e,"aria-owns",t),this._trackedModal=e}_clearFromModal(){if(this._trackedModal){let e=this.autocomplete.id;dt(this._trackedModal,"aria-owns",e),this._trackedModal=null}}};o.\u0275fac=function(t){return new(t||o)(p(Et),p(Ye),p(ri),p(ii),p(Ut),p(zi),p(gi,8),p(Oi,9),p(si,8),p(Ei),p(Hi,8))},o.\u0275dir=Xt({type:o,selectors:[["input","matAutocomplete",""],["textarea","matAutocomplete",""]],hostAttrs:[1,"mat-mdc-autocomplete-trigger"],hostVars:7,hostBindings:function(t,i){t&1&&_("focusin",function(){return i._handleFocus()})("blur",function(){return i._onTouched()})("input",function(m){return i._handleInput(m)})("keydown",function(m){return i._handleKeydown(m)})("click",function(){return i._handleClick()}),t&2&&Pe("autocomplete",i.autocompleteAttribute)("role",i.autocompleteDisabled?null:"combobox")("aria-autocomplete",i.autocompleteDisabled?null:"list")("aria-activedescendant",i.panelOpen&&i.activeOption?i.activeOption.id:null)("aria-expanded",i.autocompleteDisabled?null:i.panelOpen.toString())("aria-controls",i.autocompleteDisabled||!i.panelOpen||i.autocomplete==null?null:i.autocomplete.id)("aria-haspopup",i.autocompleteDisabled?null:"listbox")},inputs:{autocomplete:[I.None,"matAutocomplete","autocomplete"],position:[I.None,"matAutocompletePosition","position"],connectedTo:[I.None,"matAutocompleteConnectedTo","connectedTo"],autocompleteAttribute:[I.None,"autocomplete","autocompleteAttribute"],autocompleteDisabled:[I.HasDecoratorInputTransform,"matAutocompleteDisabled","autocompleteDisabled",Ae]},exportAs:["matAutocompleteTrigger"],standalone:!0,features:[Vt([Pr]),At,Zt]});let r=o;return r})(),Ct=(()=>{let o=class o{};o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=ot({type:o}),o.\u0275inj=at({providers:[Ir],imports:[Bi,jt,Lt,N,Pi,jt,Lt]});let r=o;return r})();var A=(()=>{let o=class o{usedTextValidator(e){return t=>{let i=t.value?.toLowerCase();return e.length!=0&&e.includes(i)?{forbiddenValue:!0}:null}}};o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=ot({type:o}),o.\u0275inj=at({imports:[N]});let r=o;return r})();var ke=(()=>{let o=class o extends Le{constructor(e){super(),this.http=e}getAllAuthors(e){try{let t=new G({"Content-Type":"application/json",Authorization:`Bearer ${e}`});return this.http.get(`${K.apiUrl}author`,{headers:t}).pipe($(i=>this.errorHandle(i,"Autor")))}catch{return z("Error al decodificar el token JWT.")}}getAllUserAuthors(e){try{let t=Ce(e),i=Number.parseInt(t.sub||"-1"),d=new G({"Content-Type":"application/json",Authorization:`Bearer ${e}`});return this.http.get(`${K.apiUrl}user/${i}/authors`,{headers:d}).pipe($(m=>this.errorHandle(m,"Autor")))}catch{return z("Error al decodificar el token JWT.")}}addAuthor(e,t){try{let i=Ce(t),d=Number.parseInt(i.sub||"-1"),m=new G({"Content-Type":"application/json",Authorization:`Bearer ${t}`});return e.userId=d,this.http.post(`${K.apiUrl}author`,e,{headers:m}).pipe(Me(g=>g),$(g=>this.errorHandle(g,"Libro")))}catch{return z("Error al decodificar el token JWT.")}}};o.\u0275fac=function(t){return new(t||o)(Te(Fe))},o.\u0275prov=Be({token:o,factory:o.\u0275fac,providedIn:"root"});let r=o;return r})();var je=(()=>{let o=class o extends Le{constructor(e){super(),this.http=e}getAllUniverses(e){try{let t=new G({"Content-Type":"application/json",Authorization:`Bearer ${e}`});return this.http.get(`${K.apiUrl}universe`,{headers:t}).pipe($(i=>this.errorHandle(i,"Universo")))}catch{return z("Error al decodificar el token JWT.")}}getAllUserUniverses(e){try{let t=Ce(e),i=Number.parseInt(t.sub||"-1"),d=new G({"Content-Type":"application/json",Authorization:`Bearer ${e}`});return this.http.get(`${K.apiUrl}user/${i}/universes`,{headers:d}).pipe($(m=>this.errorHandle(m,"Universo")))}catch{return z("Error al decodificar el token JWT.")}}addUniverse(e,t){try{let i=Ce(t),d=Number.parseInt(i.sub||"-1"),m=new G({"Content-Type":"application/json",Authorization:`Bearer ${t}`});return e.userId=d,console.log(e),this.http.post(`${K.apiUrl}universe`,e,{headers:m}).pipe(Me(g=>g),$(g=>this.errorHandle(g,"Universo")))}catch{return z("Error al decodificar el token JWT.")}}};o.\u0275fac=function(t){return new(t||o)(Te(Fe))},o.\u0275prov=Be({token:o,factory:o.\u0275fac,providedIn:"root"});let r=o;return r})();var St=(()=>{let o=class o extends Le{constructor(e){super(),this.http=e}getAllUserSagas(e){try{let t=Ce(e),i=Number.parseInt(t.sub||"-1"),d=new G({"Content-Type":"application/json",Authorization:`Bearer ${e}`});return this.http.get(`${K.apiUrl}user/${i}/sagas`,{headers:d}).pipe($(m=>this.errorHandle(m,"Saga")))}catch{return z("Error al decodificar el token JWT.")}}addSaga(e,t){try{let i=Ce(t),d=Number.parseInt(i.sub||"-1"),m=new G({"Content-Type":"application/json",Authorization:`Bearer ${t}`});return e.userId=d,console.log(e),this.http.post(`${K.apiUrl}saga`,e,{headers:m}).pipe(Me(g=>g),$(g=>this.errorHandle(g,"Saga")))}catch{return z("Error al decodificar el token JWT.")}}};o.\u0275fac=function(t){return new(t||o)(Te(Fe))},o.\u0275prov=Be({token:o,factory:o.\u0275fac,providedIn:"root"});let r=o;return r})();function Br(r,o){if(r&1){let a=E();n(0,"ngx-dropzone-image-preview",27),_("removed",function(){x(a);let t=h();return C(t.onRemove())}),s()}if(r&2){let a=o.$implicit;f("file",a)("removable",!0)}}function Tr(r,o){if(r&1&&(n(0,"mat-error",12),c(1),s()),r&2){let a=h();l(),v(a.errorNameMessage)}}function Nr(r,o){if(r&1&&(n(0,"mat-option",16),c(1),s()),r&2){let a=o.$implicit;f("value",a.name),l(),v(a.name)}}function Fr(r,o){if(r&1&&(n(0,"mat-error",12),c(1),s()),r&2){let a=h();l(),v(a.errorStatusMessage)}}function Rr(r,o){if(r&1&&(n(0,"mat-option",16),c(1),s()),r&2){let a=o.$implicit;f("value",a),l(),v(a)}}function Vr(r,o){if(r&1&&(n(0,"mat-error",12),c(1),s()),r&2){let a=h();l(),v(a.errorUniverseMessage)}}function Ur(r,o){if(r&1&&(n(0,"mat-option",16),c(1),s()),r&2){let a=o.$implicit;f("value",a),l(),v(a)}}function Dr(r,o){if(r&1&&(n(0,"mat-error",12),c(1),s()),r&2){let a=h();l(),v(a.errorSagaMessage)}}function Lr(r,o){if(r&1&&(n(0,"mat-option",16),c(1),s()),r&2){let a=o.$implicit;f("value",a),l(),v(a)}}function jr(r,o){if(r&1&&(n(0,"mat-error",12),c(1),s()),r&2){let a=h(2);l(),v(a.errorOrderMessage)}}function qr(r,o){if(r&1){let a=E();n(0,"mat-form-field",28)(1,"mat-label"),c(2,"Orden en saga"),s(),n(3,"mat-select",15,4),Rt("ngModelChange",function(t){x(a);let i=h();return Ft(i.defaultOrder,t)||(i.defaultOrder=t),C(t)}),V(5,Lr,2,2,"mat-option",16,W),s(),n(7,"mat-icon",11),c(8,"filter_9_plus"),s(),b(9,jr,2,1,"mat-error",12),s()}if(r&2){let a=h();l(3),f("formControl",a.order),Nt("ngModel",a.defaultOrder),l(2),U(a.orders),l(4),w(9,a.order.invalid?9:-1)}}function Hr(r,o){if(r&1&&(n(0,"mat-option",16),c(1),s()),r&2){let a=o.$implicit;f("value",a),l(),v(a.name)}}function zr(r,o){if(r&1&&(n(0,"mat-error",12),c(1),s()),r&2){let a=h();l(),v(a.errorAuthorMessage)}}function $r(r,o){if(r&1&&(n(0,"div",26),O(1,"ngx-loading",29),s()),r&2){let a=h();l(),f("show",a.waitingServerResponse)("config",a.spinnerConfig)}}var Qi=(()=>{let o=class o{constructor(e,t,i,d,m,g,F,be,qe,yt){this.loginSrv=e,this.userSrv=t,this.bookSrv=i,this.fBuild=d,this._snackBar=m,this.router=g,this.customValidator=F,this.authorSrv=be,this.universeSrv=qe,this.sagaSrv=yt,this.userData={userId:0,name:"",email:""},this.files=[],this.names=[],this.universes=[],this.idUniversoActual=1,this.sagas=[],this.orders=[-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20],this.authors=[],this.statuses=[],this.actualStatus="Por comprar",this.waitingServerResponse=!1,this.spinnerConfig={animationType:fe.chasingDots,primaryColour:"#afcec2",secondaryColour:"#000000"},this.errorNameMessage="",this.name=new S("",[u.required,u.minLength(3),u.maxLength(50),this.customValidator.usedTextValidator(this.names)]),this.errorUniverseMessage="",this.universe=new S("",[u.required]),this.errorSagaMessage="",this.saga=new S("",[u.required]),this.defaultOrder=-1,this.errorOrderMessage="",this.order=new S(-1,[u.required]),this.errorAuthorMessage="",this.author=new S(this.authors,[u.required]),this.errorStatusMessage="",this.status=new S("",[u.required]),this.fgBook=this.fBuild.group({name:this.name,universe:this.universe,saga:this.saga,order:this.order,author:this.author,status:this.status}),M(this.name.statusChanges,this.name.valueChanges).pipe(k()).subscribe(()=>this.updateNameErrorMessage()),M(this.universe.statusChanges,this.universe.valueChanges).pipe(k()).subscribe(()=>this.updateUniverseErrorMessage()),M(this.saga.statusChanges,this.saga.valueChanges).pipe(k()).subscribe(()=>this.updateSagaErrorMessage()),M(this.order.statusChanges,this.order.valueChanges).pipe(k()).subscribe(()=>this.updateOrderErrorMessage()),M(this.author.statusChanges,this.author.valueChanges).pipe(k()).subscribe(()=>this.updateAuthorErrorMessage()),M(this.status.statusChanges,this.status.valueChanges).pipe(k()).subscribe(()=>this.updateStatusErrorMessage())}ngOnInit(){let e=this.loginSrv.token;e!=null&&e!=""&&this.userSrv.getUser(e).subscribe({next:t=>R(this,null,function*(){this.userData=t,t.books&&(this.names=t.books.map(i=>i.name.toLocaleLowerCase()),this.name=new S("",[u.required,u.minLength(3),u.maxLength(50),this.customValidator.usedTextValidator(this.names)]),this.fgBook=this.fBuild.group({name:this.name,universe:this.universe,saga:this.saga,order:this.order,author:this.author,status:this.status})),this.userData.universes&&(this.universes=this.userData.universes),this.filteredUniverses=this.universe.valueChanges.pipe(Ee(""),Oe(i=>this._universeFilter(i||""))),this.universe.setValue(this.universes[0].name),this.userData.sagas&&(this.sagas=this.userData.sagas),this.filteredSagas=this.saga.valueChanges.pipe(Ee(""),Oe(i=>this._sagaFilter(i||""))),this.saga.setValue(this.sagas[0].name),this.userData.authors&&(this.authors=this.userData.authors),this.bookSrv.getAllBookStatuses(e).subscribe({next:i=>{this.statuses=i,this.actualStatus=i[0].name},error:()=>{this.loginSrv.logout(),this.router.navigateByUrl("/home")}})}),error:()=>{this.loginSrv.logout(),this.router.navigateByUrl("/home")}})}onSelect(e){this.files=[],this.files.push(e.addedFiles[0])}onRemove(){this.files=[]}updateDisplayedSagas(e){this.idUniversoActual=this.universes.find(t=>t.name==e)?.universeId??1,this.saga.setValue(""),this.saga.setValue(this._sagaFilter("")[0])}resetOrder(e){e&&e!==""&&e!==this.sagas[0].name?this.defaultOrder=1:this.defaultOrder=-1}_universeFilter(e){let t=e.toLowerCase();return this.universes.map(i=>i.name).filter(i=>i.toLowerCase().includes(t))}_sagaFilter(e){let t=e.toLowerCase();return this.sagas.filter(i=>i.universeId===this.idUniversoActual).map(i=>i.name).filter(i=>i.toLowerCase().includes(t))}updateNameErrorMessage(){this.name.hasError("required")?this.errorNameMessage="El nombre no puede quedar vac\xEDo":this.name.hasError("minlength")?this.errorNameMessage="Nombre demasiado corto":this.name.hasError("maxlength")?this.errorNameMessage="Nombre demasiado largo":this.errorNameMessage="Nombre no v\xE1lido"}updateUniverseErrorMessage(){this.universe.hasError("required")?this.errorUniverseMessage="El universo no puede quedar vac\xEDo":this.errorUniverseMessage="Universo no v\xE1lido"}updateSagaErrorMessage(){this.saga.hasError("required")?this.errorSagaMessage="La saga no puede quedar vac\xEDa":this.errorSagaMessage="Saga no v\xE1lida"}updateOrderErrorMessage(){this.order.hasError("required")?this.errorOrderMessage="El orden no puede quedar vac\xEDo":this.errorOrderMessage="Orden no v\xE1lido"}updateAuthorErrorMessage(){this.author.hasError("required")?this.errorAuthorMessage="El autor no puede quedar vac\xEDo":this.errorAuthorMessage="Autor no v\xE1lido"}updateStatusErrorMessage(){this.status.hasError("required")?this.errorStatusMessage="El estado no puede quedar vac\xEDo":this.errorStatusMessage="Estado no v\xE1lido"}addBook(){if(this.fgBook.invalid||this.files.length===0){this._snackBar.openSnackBar("Error de campos, faltan campos por rellenar","errorBar");return}this.waitingServerResponse=!0;let e=this.loginSrv.token,t=this.universes.find(g=>g.name===this.universe.value);if(!t)return;let i=this.sagas.find(g=>g.name===this.saga.value);if(!i)return;let d=this.statuses.find(g=>g.name===this.status.value);if(!d)return;let m={bookId:0,userId:0,cover:"",status:d,name:this.name.value??"",universe:t,saga:i,orderInSaga:this.order.value??-1,authors:this.author.value??[],chapters:[],characters:[]};this.bookSrv.addBook(m,this.files[0],e).subscribe({next:()=>{this.fgBook.reset(),this.router.navigateByUrl("/dashboard/books?bookAdded=true")},error:g=>{this.waitingServerResponse=!1,this._snackBar.openSnackBar(g,"errorBar")},complete:()=>{this.waitingServerResponse=!1}})}};o.\u0275fac=function(t){return new(t||o)(p(j),p(q),p(ut),p(re),p(y),p(D),p(A),p(ke),p(je),p(St))},o.\u0275cmp=B({type:o,selectors:[["app-add-book"]],standalone:!0,features:[T],decls:66,vars:24,consts:[["statusSelect",""],["autoUniverses","matAutocomplete"],["autosagas","matAutocomplete"],["authorsSelect",""],["orderSelect",""],[1,"p-3"],[3,"ngSubmit","formGroup"],["ngx-dropzone","",1,"custom-dropzone",3,"change","accept"],[3,"file","removable","removed",4,"ngFor","ngForOf"],["appearance","outline","primary","",1,"name","mb-3"],["matInput","","formControlName","name","required","",3,"blur"],["matTextPrefix","",1,"me-3"],["align","start"],["align","end"],["appearance","outline",1,"status","mb-3"],[3,"ngModelChange","formControl","ngModel"],[3,"value"],["appearance","outline",1,"w-100","mb-3"],["type","text","aria-label","Universo","matInput","",3,"formControl","matAutocomplete"],[3,"optionSelected"],["appearance","outline",1,"saga","mb-3"],["type","text","aria-label","Saga","matInput","",3,"formControl","matAutocomplete"],["appearance","outline","class","order mb-3",4,"ngIf"],["multiple","",3,"formControl"],[1,"w-100"],["mat-raised-button","",3,"disabled"],[1,"spinner-wrapper"],[3,"removed","file","removable"],["appearance","outline",1,"order","mb-3"],[3,"show","config"]],template:function(t,i){if(t&1){let d=E();n(0,"mat-card",5)(1,"form",6),_("ngSubmit",function(){return x(d),C(i.addBook())}),n(2,"div",7),_("change",function(g){return x(d),C(i.onSelect(g))}),n(3,"ngx-dropzone-label"),c(4,"Dame una portada!"),s(),b(5,Br,1,2,"ngx-dropzone-image-preview",8),s(),n(6,"mat-form-field",9)(7,"mat-label"),c(8,"T\xEDtulo del libro"),s(),n(9,"input",10),_("blur",function(){return x(d),C(i.updateNameErrorMessage())}),s(),n(10,"mat-icon",11),c(11,"book"),s(),b(12,Tr,2,1,"mat-error",12),n(13,"mat-hint",13),c(14),s()(),n(15,"mat-form-field",14)(16,"mat-label"),c(17,"Estado"),s(),n(18,"mat-select",15,0),Rt("ngModelChange",function(g){return x(d),Ft(i.actualStatus,g)||(i.actualStatus=g),C(g)}),V(20,Nr,2,2,"mat-option",16,W),s(),n(22,"mat-icon",11),c(23),s(),b(24,Fr,2,1,"mat-error",12),s(),n(25,"mat-form-field",17)(26,"mat-label"),c(27,"Universo"),s(),O(28,"input",18),n(29,"mat-autocomplete",19,1),_("optionSelected",function(g){return x(d),C(i.updateDisplayedSagas(g.option.value))}),V(31,Rr,2,2,"mat-option",16,W),We(33,"async"),s(),n(34,"mat-icon",11),c(35,"grain"),s(),b(36,Vr,2,1,"mat-error",12),s(),n(37,"mat-form-field",20)(38,"mat-label"),c(39,"Saga"),s(),O(40,"input",21),n(41,"mat-autocomplete",19,2),_("optionSelected",function(g){return x(d),C(i.resetOrder(g.option.value))}),V(43,Ur,2,2,"mat-option",16,W),We(45,"async"),s(),n(46,"mat-icon",11),c(47,"device_hub"),s(),b(48,Dr,2,1,"mat-error",12),s(),b(49,qr,10,3,"mat-form-field",22),n(50,"mat-form-field",17)(51,"mat-label"),c(52,"Autor/es"),s(),n(53,"mat-select",23,3),V(55,Hr,2,2,"mat-option",16,W),s(),n(57,"mat-icon",11),c(58,"record_voice_over"),s(),b(59,zr,2,1,"mat-error",12),s(),n(60,"div",24)(61,"button",25),c(62," A\xF1adir libro "),n(63,"mat-icon"),c(64,"border_color"),s()(),b(65,$r,2,2,"div",26),s()()()}if(t&2){let d=xe(30),m=xe(42);l(),f("formGroup",i.fgBook),l(),f("accept","image/*"),l(3),f("ngForOf",i.files),l(7),w(12,i.name.invalid?12:-1),l(2),P("",i.name.value?i.name.value.length:0," / 50"),l(4),f("formControl",i.status),Nt("ngModel",i.actualStatus),l(2),U(i.statuses),l(3),v(i.actualStatus==="Por comprar"?"remove_shopping_cart":i.actualStatus==="En espera"?"access_time":i.actualStatus==="En marcha"?"local_library":"done_all"),l(),w(24,i.status.invalid?24:-1),l(4),f("formControl",i.universe)("matAutocomplete",d),l(3),U(Ge(33,20,i.filteredUniverses)),l(5),w(36,i.universe.invalid?36:-1),l(4),f("formControl",i.saga)("matAutocomplete",m),l(3),U(Ge(45,22,i.filteredSagas)),l(5),w(48,i.saga.invalid?48:-1),l(),f("ngIf",i.sagas&&i.sagas.length>0&&i.saga.value&&i.saga.value!==i.sagas[0].name),l(4),f("formControl",i.author),l(2),U(i.authors),l(4),w(59,i.author.invalid?59:-1),l(2),f("disabled",i.fgBook.invalid||i.waitingServerResponse),l(4),w(65,i.waitingServerResponse?65:-1)}},dependencies:[Y,pt,Ri,Fi,Vi,N,ci,st,lt,Ve,ce,oe,se,ne,le,ye,Z,Q,J,X,ie,ae,Re,ee,te,de,L,_e,ge,pe,me,he,ue,Ct,xt,we,et,De,Ue,A,y],styles:[".cdk-overlay-pane:has(.errorBar){position:absolute!important;top:50px}  .cdk-overlay-pane:has(.errorBar) .mdc-snackbar__surface{background-color:#df4141!important;color:#2c2a2a}  .cdk-overlay-pane:has(.errorBarMenu){position:absolute!important;top:350px;left:50px}  .cdk-overlay-pane:has(.errorBarMenu) .mdc-snackbar__surface{background-color:#df4141!important;color:#2c2a2a}  .cdk-overlay-pane:has(.successBar){margin-top:50px!important}  .cdk-overlay-pane:has(.successBar) .mdc-snackbar__surface{background-color:#26da5c!important}  .cdk-overlay-pane:has(.successBar) .mdc-snackbar__surface .mat-mdc-snack-bar-label{color:#000}  .cdk-overlay-pane:has(.successBar) .mdc-snackbar__surface .mdc-button__label{color:#6c198a}  .cdk-overlay-pane:has(.successBarMenu){position:absolute!important;top:350px;left:50px}  .cdk-overlay-pane:has(.successBarMenu) .mdc-snackbar__surface{background-color:#26da5c!important}  .cdk-overlay-pane:has(.successBarMenu) .mdc-snackbar__surface .mat-mdc-snack-bar-label{color:#000}  .cdk-overlay-pane:has(.successBarMenu) .mdc-snackbar__surface .mdc-button__label{color:#6c198a}  .cdk-overlay-pane:has(.successBar-margin){margin-top:120px!important}  .cdk-overlay-pane:has(.successBar-margin) .mdc-snackbar__surface{background-color:#26da5c!important}  .cdk-overlay-pane:has(.successBar-margin) .mdc-snackbar__surface .mat-mdc-snack-bar-label{color:#000}  .cdk-overlay-pane:has(.successBar-margin) .mdc-snackbar__surface .mdc-button__label{color:#6c198a}form[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]     .mat-mdc-form-field-flex{align-items:center!important}form[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]     .mat-mdc-form-field-flex .mat-mdc-form-field-text-prefix{display:flex}form[_ngcontent-%COMP%]   .spinner-wrapper[_ngcontent-%COMP%]{position:absolute;right:25%}[_nghost-%COMP%]{display:flex;justify-content:center;align-items:center;height:100%}mat-card[_ngcontent-%COMP%]{max-height:100%;background-color:#ac977d66;border:solid black 1px;border-radius:4px;box-shadow:5px 5px 5px #171717}mat-card[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{display:flex;align-items:center;flex-flow:row wrap}mat-card[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .custom-dropzone[_ngcontent-%COMP%]{width:150px;color:#171717;background-color:transparent;border-color:#171717;padding:5px;margin-bottom:15px}mat-card[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;justify-content:center}mat-card[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:40%}mat-card[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%], mat-card[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .saga[_ngcontent-%COMP%]{flex:1 1 auto}mat-card[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%], mat-card[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .status[_ngcontent-%COMP%], mat-card[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .order[_ngcontent-%COMP%]{margin-left:10px}@media screen and (max-width: 1050px){mat-card[_ngcontent-%COMP%]{overflow:auto}mat-card[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   .custom-dropzone[_ngcontent-%COMP%]{width:100px;height:140px}mat-card[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{width:100%;margin-left:0}mat-card[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:55%}}"]});let r=o;return r})();function Wr(r,o){if(r&1&&(n(0,"mat-error",6),c(1),s()),r&2){let a=h();l(),v(a.errorNameMessage)}}function Gr(r,o){if(r&1&&(n(0,"div",10),O(1,"ngx-loading",11),s()),r&2){let a=h();l(),f("show",a.waitingServerResponse)("config",a.spinnerConfig)}}var Ji=(()=>{let o=class o{constructor(e,t,i,d,m,g,F){this.userSrv=e,this.loginSrv=t,this.authorSrv=i,this.router=d,this.fBuild=m,this._snackBar=g,this.customValidator=F,this.userData={userId:0,name:"",email:""},this.names=[],this.waitingServerResponse=!1,this.spinnerConfig={animationType:fe.chasingDots,primaryColour:"#afcec2",secondaryColour:"#000000"},this.errorNameMessage="",this.name=new S("",[u.required,u.minLength(3),u.maxLength(50),this.customValidator.usedTextValidator(this.names)]),this.fgAuthor=this.fBuild.group({name:this.name}),M(this.name.statusChanges,this.name.valueChanges).pipe(k()).subscribe(()=>this.updateNameErrorMessage())}ngOnInit(){let e=this.loginSrv.token;e!=null&&e!=""&&this.userSrv.getUser(e).subscribe({next:t=>R(this,null,function*(){this.userData=t,t.authors&&(this.names=t.authors.map(i=>i.name.toLocaleLowerCase()),this.name=new S("",[u.required,u.minLength(3),u.maxLength(50),this.customValidator.usedTextValidator(this.names)]),this.fgAuthor=this.fBuild.group({name:this.name}))}),error:()=>{this.loginSrv.logout(),this.router.navigateByUrl("/home")}})}updateNameErrorMessage(){this.name.hasError("required")?this.errorNameMessage="El nombre no puede quedar vac\xEDo":this.name.hasError("minlength")?this.errorNameMessage="Nombre demasiado corto":this.name.hasError("maxlength")?this.errorNameMessage="Nombre demasiado largo":this.name.hasError("forbiddenValue")?this.errorNameMessage="Autor ya registrado":this.errorNameMessage="Nombre no v\xE1lido"}addAuthor(){if(this.fgAuthor.invalid){this._snackBar.openSnackBar("Error: "+this.fgAuthor.errors,"errorBar");return}let e=this.loginSrv.token;this.authorSrv.addAuthor(this.fgAuthor.value,e).subscribe({next:()=>{this.fgAuthor.reset(),this.router.navigateByUrl("/dashboard/books?authorAdded=true")},error:t=>{this._snackBar.openSnackBar(t,"errorBar")}})}};o.\u0275fac=function(t){return new(t||o)(p(q),p(j),p(ke),p(D),p(re),p(y),p(A))},o.\u0275cmp=B({type:o,selectors:[["app-add-author"]],standalone:!0,features:[T],decls:17,vars:5,consts:[[1,"p-3"],[3,"ngSubmit","formGroup"],["appearance","outline",1,"w-100","mb-3"],[1,"ms-3"],["matInput","","formControlName","name","required","",1,"ms-3",3,"change"],["matTextPrefix",""],["align","start"],["align","end"],[1,"position-relative"],["mat-raised-button","",3,"disabled"],[1,"spinner-wrapper"],[3,"show","config"]],template:function(t,i){t&1&&(n(0,"mat-card",0)(1,"form",1),_("ngSubmit",function(){return i.addAuthor()}),n(2,"mat-form-field",2)(3,"mat-label",3),c(4,"Nombre/Pseud\xF3nimo del autor"),s(),n(5,"input",4),_("change",function(){return i.updateNameErrorMessage()}),s(),n(6,"mat-icon",5),c(7,"record_voice_over"),s(),b(8,Wr,2,1,"mat-error",6),n(9,"mat-hint",7),c(10),s()(),n(11,"div",8)(12,"button",9),c(13," A\xF1adir autor "),n(14,"mat-icon"),c(15,"border_color"),s()(),b(16,Gr,2,2,"div",10),s()()()),t&2&&(l(),f("formGroup",i.fgAuthor),l(7),w(8,i.name.invalid?8:-1),l(2),P("",i.name.value?i.name.value.length:0," / 50"),l(2),f("disabled",i.fgAuthor.invalid||i.waitingServerResponse),l(4),w(16,i.waitingServerResponse?16:-1))},dependencies:[Ve,ce,oe,se,ne,le,pe,me,ye,Z,Q,J,X,ie,ae,ee,te,he,ue,Se,Y,de,L,_e,ge,A,y],styles:["form[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]     .mat-mdc-form-field-flex{align-items:center!important}form[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]     .mat-mdc-form-field-flex .mat-mdc-form-field-text-prefix{display:flex}form[_ngcontent-%COMP%]   .spinner-wrapper[_ngcontent-%COMP%]{position:absolute;right:25%}[_nghost-%COMP%]{display:flex;justify-content:center;align-items:center;height:100%}mat-card[_ngcontent-%COMP%]{min-width:400px;background-color:#ac977d66;border:solid black 1px;border-radius:4px;box-shadow:5px 5px 5px #171717}mat-card[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;justify-content:center}@media screen and (max-width: 1050px){mat-card[_ngcontent-%COMP%]{width:95%;min-width:0}}"]});let r=o;return r})();function Kr(r,o){if(r&1&&(n(0,"mat-error",5),c(1),s()),r&2){let a=h();l(),v(a.errorNameMessage)}}function Yr(r,o){if(r&1&&(n(0,"mat-option",8),c(1),s()),r&2){let a=o.$implicit;f("value",a),l(),v(a.name)}}function Qr(r,o){if(r&1&&(n(0,"div",11),O(1,"ngx-loading",12),s()),r&2){let a=h();l(),f("show",a.waitingServerResponse)("config",a.spinnerConfig)}}var Xi=(()=>{let o=class o{constructor(e,t,i,d,m,g,F,be){this.userSrv=e,this.loginSrv=t,this.universeSrv=i,this.router=d,this.fBuild=m,this._snackBar=g,this.customValidator=F,this.authorSrv=be,this.userData={userId:0,name:"",email:""},this.names=[],this.authors=[],this.waitingServerResponse=!1,this.spinnerConfig={animationType:fe.chasingDots,primaryColour:"#afcec2",secondaryColour:"#000000"},this.errorNameMessage="",this.name=new S("",[u.required,u.minLength(3),u.maxLength(50),this.customValidator.usedTextValidator(this.names)]),this.errorAuthorMessage="",this.author=new S([],[u.required]),this.fgUniverse=this.fBuild.group({name:this.name,author:this.author}),M(this.name.statusChanges,this.name.valueChanges).pipe(k()).subscribe(()=>this.updateNameErrorMessage()),M(this.author.statusChanges,this.author.valueChanges).pipe(k()).subscribe(()=>this.updateAuthorErrorMessage())}ngOnInit(){let e=this.loginSrv.token;e!=null&&e!=""&&(this.userSrv.getUser(e).subscribe({next:t=>R(this,null,function*(){this.userData=t,t.universes&&(this.names=t.universes.map(i=>i.name.toLocaleLowerCase()),this.name=new S("",[u.required,u.minLength(3),u.maxLength(50),this.customValidator.usedTextValidator(this.names)]),this.fgUniverse=this.fBuild.group({name:this.name,author:this.author}))}),error:()=>{this.loginSrv.logout(),this.router.navigateByUrl("/home")}}),this.authorSrv.getAllAuthors(e).subscribe({next:t=>R(this,null,function*(){this.authors=t}),error:()=>{this.loginSrv.logout(),this.router.navigateByUrl("/home")}}))}updateNameErrorMessage(){this.name.hasError("required")?this.errorNameMessage="El nombre no puede quedar vac\xEDo":this.name.hasError("minlength")?this.errorNameMessage="Nombre demasiado corto":this.name.hasError("maxlength")?this.errorNameMessage="Nombre demasiado largo":this.name.hasError("forbiddenValue")?this.errorNameMessage="Universo ya registrado":this.errorNameMessage="Nombre no v\xE1lido"}updateAuthorErrorMessage(){this.name.hasError("required")?this.errorNameMessage="El universo debe tener al menos un autor":this.errorNameMessage="Autor no v\xE1lido"}addUniverse(){if(this.fgUniverse.invalid){this._snackBar.openSnackBar("Error: "+this.fgUniverse.errors,"errorBar");return}let e=this.loginSrv.token;this.universeSrv.addUniverse(this.fgUniverse.value,e).subscribe({next:()=>{this.fgUniverse.reset(),this.router.navigateByUrl("/dashboard/books?universeAdded=true")},error:t=>{this._snackBar.openSnackBar(t,"errorBar")}})}};o.\u0275fac=function(t){return new(t||o)(p(q),p(j),p(je),p(D),p(re),p(y),p(A),p(ke))},o.\u0275cmp=B({type:o,selectors:[["app-add-universe"]],standalone:!0,features:[T],decls:25,vars:6,consts:[[1,"p-3"],[3,"ngSubmit","formGroup"],["appearance","outline",1,"w-100","mb-3"],["matInput","","formControlName","name","required","",3,"change"],["matTextPrefix","",1,"me-3"],["align","start"],["align","end"],["multiple","",3,"formControl"],[3,"value"],[1,"position-relative"],["mat-raised-button","",3,"disabled"],[1,"spinner-wrapper"],[3,"show","config"]],template:function(t,i){t&1&&(n(0,"mat-card",0)(1,"form",1),_("ngSubmit",function(){return i.addUniverse()}),n(2,"mat-form-field",2)(3,"mat-label"),c(4,"Nombre del universo"),s(),n(5,"input",3),_("change",function(){return i.updateNameErrorMessage()}),s(),n(6,"mat-icon",4),c(7,"grain"),s(),b(8,Kr,2,1,"mat-error",5),n(9,"mat-hint",6),c(10),s()(),n(11,"mat-form-field",2)(12,"mat-label"),c(13,"Autor/es"),s(),n(14,"mat-select",7),V(15,Yr,2,2,"mat-option",8,W),s(),n(17,"mat-icon",4),c(18,"record_voice_over"),s()(),n(19,"div",9)(20,"button",10),c(21," A\xF1adir universo "),n(22,"mat-icon"),c(23,"border_color"),s()(),b(24,Qr,2,2,"div",11),s()()()),t&2&&(l(),f("formGroup",i.fgUniverse),l(7),w(8,i.name.invalid?8:-1),l(2),P("",i.name.value?i.name.value.length:0," / 50"),l(4),f("formControl",i.author),l(),U(i.authors),l(5),f("disabled",i.fgUniverse.invalid||i.waitingServerResponse),l(4),w(24,i.waitingServerResponse?24:-1))},dependencies:[Se,Y,ye,Z,Q,J,X,ie,ae,Re,ee,te,pe,me,ce,oe,se,ne,le,he,ue,N,de,L,_e,ge,A,De,Ue,we,y],styles:["form[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]     .mat-mdc-form-field-flex{align-items:center!important}form[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]     .mat-mdc-form-field-flex .mat-mdc-form-field-text-prefix{display:flex}form[_ngcontent-%COMP%]   .spinner-wrapper[_ngcontent-%COMP%]{position:absolute;right:25%}[_nghost-%COMP%]{display:flex;justify-content:center;align-items:center;height:100%}mat-card[_ngcontent-%COMP%]{min-width:20vw;background-color:#ac977d66;border:solid black 1px;border-radius:4px;box-shadow:5px 5px 5px #171717}mat-card[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;justify-content:center}"]});let r=o;return r})();function Jr(r,o){if(r&1&&(n(0,"mat-error",7),c(1),s()),r&2){let a=h();l(),v(a.errorNameMessage)}}function Xr(r,o){if(r&1&&(n(0,"mat-option",10),c(1),s()),r&2){let a=o.$implicit;f("value",a),l(),v(a)}}function Zr(r,o){if(r&1&&(n(0,"mat-error",7),c(1),s()),r&2){let a=h();l(),v(a.errorUniverseMessage)}}function ea(r,o){if(r&1&&(n(0,"mat-option",10),c(1),s()),r&2){let a=o.$implicit;f("value",a),l(),v(a.name)}}function ta(r,o){if(r&1&&(n(0,"div",14),O(1,"ngx-loading",15),s()),r&2){let a=h();l(),f("show",a.waitingServerResponse)("config",a.spinnerConfig)}}var Zi=(()=>{let o=class o{constructor(e,t,i,d,m,g,F,be,qe){this.userSrv=e,this.loginSrv=t,this.sagaSrv=i,this.router=d,this.fBuild=m,this._snackBar=g,this.customValidator=F,this.authorSrv=be,this.universeSrv=qe,this.userData={userId:0,name:"",email:""},this.names=[],this.universes=[],this.authors=[],this.waitingServerResponse=!1,this.spinnerConfig={animationType:fe.chasingDots,primaryColour:"#afcec2",secondaryColour:"#000000"},this.errorNameMessage="",this.name=new S("",[u.required,u.minLength(3),u.maxLength(50),this.customValidator.usedTextValidator(this.names)]),this.errorUniverseMessage="",this.universe=new S("",[u.required]),this.errorAuthorMessage="",this.author=new S([],[u.required]),this.fgSaga=this.fBuild.group({name:this.name,universe:this.universe,author:this.author}),M(this.name.statusChanges,this.name.valueChanges).pipe(k()).subscribe(()=>this.updateNameErrorMessage()),M(this.universe.statusChanges,this.universe.valueChanges).pipe(k()).subscribe(()=>this.updateUniverseErrorMessage()),M(this.author.statusChanges,this.author.valueChanges).pipe(k()).subscribe(()=>this.updateAuthorErrorMessage())}ngOnInit(){let e=this.loginSrv.token;e!=null&&e!=""&&(this.userSrv.getUser(e).subscribe({next:t=>R(this,null,function*(){this.userData=t,t.sagas&&(this.names=t.sagas.map(i=>i.name.toLocaleLowerCase()),this.name=new S("",[u.required,u.minLength(3),u.maxLength(50),this.customValidator.usedTextValidator(this.names)]),this.fgSaga=this.fBuild.group({name:this.name,universe:this.universe,author:this.author}))}),error:()=>{this.loginSrv.logout(),this.router.navigateByUrl("/home")}}),this.universeSrv.getAllUserUniverses(e).subscribe({next:t=>{this.universes=t,this.filteredUniverses=this.universe.valueChanges.pipe(Ee(""),Oe(i=>this._universeFilter(i||"")))},error:()=>{this.loginSrv.logout(),this.router.navigateByUrl("/home")}}),this.authorSrv.getAllUserAuthors(e).subscribe({next:t=>{this.authors=t},error:()=>{this.loginSrv.logout(),this.router.navigateByUrl("/home")}}))}_universeFilter(e){let t=e.toLowerCase();return this.universes.map(i=>i.name).filter(i=>i.toLowerCase().includes(t))}updateNameErrorMessage(){this.name.hasError("required")?this.errorNameMessage="El nombre no puede quedar vac\xEDo":this.name.hasError("minlength")?this.errorNameMessage="Nombre demasiado corto":this.name.hasError("maxlength")?this.errorNameMessage="Nombre demasiado largo":this.name.hasError("forbiddenValue")?this.errorNameMessage="Saga ya registrada":this.errorNameMessage="Nombre no v\xE1lido"}updateUniverseErrorMessage(){this.universe.hasError("required")?this.errorUniverseMessage="El universo no puede quedar vac\xEDo":this.errorUniverseMessage="Universo no v\xE1lido"}updateAuthorErrorMessage(){this.author.hasError("required")?this.errorAuthorMessage="El autor no puede quedar vac\xEDo":this.errorAuthorMessage="Autor no v\xE1lido"}addSaga(){if(this.fgSaga.invalid){this._snackBar.openSnackBar("Error: "+this.fgSaga.errors,"errorBar");return}this.waitingServerResponse=!0;let e=this.loginSrv.token,t=this.universes.find(d=>d.name===this.universe.value);if(!t)return;let i={sagaId:0,userId:0,name:this.name.value??"",universe:t,universeId:t.universeId,authors:this.author.value??[]};this.sagaSrv.addSaga(i,e).subscribe({next:()=>{this.fgSaga.reset(),this.router.navigateByUrl("/dashboard/books?sagaAdded=true")},error:d=>{this._snackBar.openSnackBar(d,"errorBar")},complete:()=>{this.waitingServerResponse=!1}})}};o.\u0275fac=function(t){return new(t||o)(p(q),p(j),p(St),p(D),p(re),p(y),p(A),p(ke),p(je))},o.\u0275cmp=B({type:o,selectors:[["app-add-saga"]],standalone:!0,features:[T],decls:38,vars:11,consts:[["autoUniverses","matAutocomplete"],["authorsSelect",""],[1,"p-3"],[3,"ngSubmit","formGroup"],["appearance","outline",1,"w-100","mb-3"],["matInput","","formControlName","name","required","",3,"change"],["matTextPrefix","",1,"me-3"],["align","start"],["align","end"],["type","text","aria-label","Universo","matInput","",3,"formControl","matAutocomplete"],[3,"value"],["multiple","",3,"formControl"],[1,"position-relative"],["mat-raised-button","",3,"disabled"],[1,"spinner-wrapper"],[3,"show","config"]],template:function(t,i){if(t&1){let d=E();n(0,"mat-card",2)(1,"form",3),_("ngSubmit",function(){return x(d),C(i.addSaga())}),n(2,"mat-form-field",4)(3,"mat-label"),c(4,"Nombre de la saga"),s(),n(5,"input",5),_("change",function(){return x(d),C(i.updateNameErrorMessage())}),s(),n(6,"mat-icon",6),c(7,"device_hub"),s(),b(8,Jr,2,1,"mat-error",7),n(9,"mat-hint",8),c(10),s()(),n(11,"mat-form-field",4)(12,"mat-label"),c(13,"Universo"),s(),O(14,"input",9),n(15,"mat-autocomplete",null,0),V(17,Xr,2,2,"mat-option",10,W),We(19,"async"),s(),n(20,"mat-icon",6),c(21,"grain"),s(),b(22,Zr,2,1,"mat-error",7),s(),n(23,"mat-form-field",4)(24,"mat-label"),c(25,"Autor/es"),s(),n(26,"mat-select",11,1),V(28,ea,2,2,"mat-option",10,W),s(),n(30,"mat-icon",6),c(31,"record_voice_over"),s()(),n(32,"div",12)(33,"button",13),c(34," A\xF1adir saga "),n(35,"mat-icon"),c(36,"border_color"),s()(),b(37,ta,2,2,"div",14),s()()()}if(t&2){let d=xe(16);l(),f("formGroup",i.fgSaga),l(7),w(8,i.name.invalid?8:-1),l(2),P("",i.name.value?i.name.value.length:0," / 50"),l(4),f("formControl",i.universe)("matAutocomplete",d),l(3),U(Ge(19,9,i.filteredUniverses)),l(5),w(22,i.universe.invalid?22:-1),l(4),f("formControl",i.author),l(2),U(i.authors),l(5),f("disabled",i.fgSaga.invalid||i.waitingServerResponse),l(4),w(37,i.waitingServerResponse?37:-1)}},dependencies:[Se,Y,ye,Z,Q,J,X,ie,ae,Re,ee,te,pe,me,ce,oe,se,ne,le,he,ue,N,lt,de,L,_e,ge,A,Ct,xt,we,et,De,Ue,y],styles:[".cdk-overlay-pane:has(.errorBar){position:absolute!important;top:50px}  .cdk-overlay-pane:has(.errorBar) .mdc-snackbar__surface{background-color:#df4141!important;color:#2c2a2a}  .cdk-overlay-pane:has(.errorBarMenu){position:absolute!important;top:350px;left:50px}  .cdk-overlay-pane:has(.errorBarMenu) .mdc-snackbar__surface{background-color:#df4141!important;color:#2c2a2a}  .cdk-overlay-pane:has(.successBar){margin-top:50px!important}  .cdk-overlay-pane:has(.successBar) .mdc-snackbar__surface{background-color:#26da5c!important}  .cdk-overlay-pane:has(.successBar) .mdc-snackbar__surface .mat-mdc-snack-bar-label{color:#000}  .cdk-overlay-pane:has(.successBar) .mdc-snackbar__surface .mdc-button__label{color:#6c198a}  .cdk-overlay-pane:has(.successBarMenu){position:absolute!important;top:350px;left:50px}  .cdk-overlay-pane:has(.successBarMenu) .mdc-snackbar__surface{background-color:#26da5c!important}  .cdk-overlay-pane:has(.successBarMenu) .mdc-snackbar__surface .mat-mdc-snack-bar-label{color:#000}  .cdk-overlay-pane:has(.successBarMenu) .mdc-snackbar__surface .mdc-button__label{color:#6c198a}  .cdk-overlay-pane:has(.successBar-margin){margin-top:120px!important}  .cdk-overlay-pane:has(.successBar-margin) .mdc-snackbar__surface{background-color:#26da5c!important}  .cdk-overlay-pane:has(.successBar-margin) .mdc-snackbar__surface .mat-mdc-snack-bar-label{color:#000}  .cdk-overlay-pane:has(.successBar-margin) .mdc-snackbar__surface .mdc-button__label{color:#6c198a}form[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]     .mat-mdc-form-field-flex{align-items:center!important}form[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]     .mat-mdc-form-field-flex .mat-mdc-form-field-text-prefix{display:flex}form[_ngcontent-%COMP%]   .spinner-wrapper[_ngcontent-%COMP%]{position:absolute;right:25%}[_nghost-%COMP%]{display:flex;justify-content:center;align-items:center;height:100%}mat-card[_ngcontent-%COMP%]{background-color:#ac977d66;border:solid black 1px;border-radius:4px;box-shadow:5px 5px 5px #171717}mat-card[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{display:flex;justify-content:center}"]});let r=o;return r})();var Tn=[{path:"",children:[{path:"books",component:Ui,canActivate:[Ie]},{path:"profile",component:Li,canActivate:[Ie]},{path:"addBook",component:Qi,canActivate:[Ie]},{path:"addAuthor",component:Ji,canActivate:[Ie]},{path:"addUniverse",component:Xi,canActivate:[Ie]},{path:"addSaga",component:Zi,canActivate:[Ie]},{path:"",redirectTo:"books",pathMatch:"full"},{path:"**",redirectTo:"books"}]}];export{Tn as routes};
